<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0066)http://www.secdev.org/projects/scapy/doc/usage.html#udp-traceroute -->
<html xmlns="http://www.w3.org/1999/xhtml" class="translated-ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    
    <title>用法 -  Scapy v2.1.1-dev文档</title>
    <link rel="stylesheet" href="./用法 - Scapy v2.1.1-dev文档_files/default.css" type="text/css">
    <link rel="stylesheet" href="./用法 - Scapy v2.1.1-dev文档_files/pygments.css" type="text/css">
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '#',
        VERSION:     '2.1.1-dev',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="./用法 - Scapy v2.1.1-dev文档_files/jquery.js.下载"></script>
    <script type="text/javascript" src="./用法 - Scapy v2.1.1-dev文档_files/doctools.js.下载"></script>
    <link rel="top" title="Scapy v2.1.1-dev文档" href="http://www.secdev.org/projects/scapy/doc/index.html">
    <link rel="next" title="高级用法" href="http://www.secdev.org/projects/scapy/doc/advanced_usage.html">
    <link rel="prev" title="下载并安装" href="http://www.secdev.org/projects/scapy/doc/installation.html"> 
  <link type="text/css" rel="stylesheet" charset="UTF-8" href="./用法 - Scapy v2.1.1-dev文档_files/translateelement.css"></head>
  <body>
    <div class="related">
      <h3><font><font>导航</font></font></h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="http://www.secdev.org/projects/scapy/doc/genindex.html" title="一般指数" accesskey="I"><font><font>指数</font></font></a></li>
        <li class="right">
          <a href="http://www.secdev.org/projects/scapy/doc/advanced_usage.html" title="高级用法" accesskey="N"><font><font>下一个</font></font></a><font><font> |</font></font></li>
        <li class="right">
          <a href="http://www.secdev.org/projects/scapy/doc/installation.html" title="下载并安装" accesskey="P"><font><font>上一页</font></font></a><font><font> |</font></font></li>
        <li><a href="http://www.secdev.org/projects/scapy/doc/index.html"><font><font>Scapy v2.1.1-dev文档</font></font></a><font><font> »</font></font></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="usage">
<h1><font><font>用法</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#usage" title="固定到这个标题"><font><font>¶</font></font></a></h1>
<div class="section" id="starting-scapy">
<h2><font><font>启动Scapy的</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#starting-scapy" title="固定到这个标题"><font><font>¶</font></font></a></h2>
<p><font><font>Scapy的交互式shell在终端会话中运行。</font><font>发送数据包需要root权限，所以我们在</font><font>这里</font><font>使用</font></font><tt class="docutils literal"><span class="pre"><font><font>sudo</font></font></span></tt><font><font>：</font></font></p>
<div class="highlight-python"><pre><font><font>$ sudo scapy </font></font><font><font>
欢迎来到Scapy（2.0.1-dev）</font></font><font><font>
&gt;&gt;&gt;</font></font></pre>
</div>
<p><font><font>在Windows上，请打开命令提示符（</font></font><tt class="docutils literal"><span class="pre"><font><font>cmd.exe</font></font></span></tt><font><font>），并确保您具有管理员权限：</font></font></p>
<div class="highlight-python"><pre><font><font>C：\&gt; scapy </font></font><font><font>
信息：内核不支持IPv6 </font></font><font><font>
警告：找不到IPv6目的地路由::（没有默认路由？）</font></font><font><font>
欢迎来到Scapy（2.0.1-dev）</font></font><font><font>
&gt;&gt;&gt;</font></font></pre>
</div>
<p><font><font>如果您没有安装所有可选软件包，Scapy将通知您某些功能将不可用：</font></font></p>
<div class="highlight-python"><pre><font><font>INFO：无法导入python gnuplot包装。</font><font>将无法绘制。</font></font><font><font>
信息：无法导入PyX。</font><font>将无法使用psdump（）或pdfdump（）。</font></font></pre>
</div>
<p><font><font>发送和接收数据包的基本功能仍然可以正常工作。</font></font></p>
</div>
<div class="section" id="interactive-tutorial">
<h2><font><font>互动教程</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#interactive-tutorial" title="固定到这个标题"><font><font>¶</font></font></a></h2>
<p><font><font>本节将介绍几种Scapy的功能。</font><font>只需打开一个Scapy会话，如上所示，自己尝试这些例子。</font></font></p>
<div class="section" id="first-steps">
<h3><font><font>第一步</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#first-steps" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p><font><font>我们来构建一个数据包并玩它：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>a </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>ttl </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>10 </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>a </font></font></span>
<span class="go"><font><font>&lt;IP ttl = 10 |&gt; </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>a </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>SRC </font></font></span>
<span class="go"><font><font>'127.0.0.1' </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>一个</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168.1.1” </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>a </font></font></span>
<span class="go"><font><font>&lt;IP ttl = 10 dst = 192.168.1.1 |&gt; </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>a </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>SRC </font></font></span>
<span class="go"><font><font>'192.168.8.14' </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="k"><font><font>德尔</font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>一个</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>TTL </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>一个</font></font></span>
<span class="go"><font><font>&lt;IP DST = 192.168.1.1 |&gt; </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>一个</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>ttl </font></font></span>
<span class="go"><font><font>64</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="stacking-layers">
<h3><font><font>堆叠层</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#stacking-layers" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p><font><font>的</font></font><tt class="docutils literal"><span class="pre"><font><font>/</font></font></span></tt><font><font>操作者已被用作两层之间的组合物操作。</font><font>当这样做时，下层可以使其一个或多个缺省字段根据上层重载。</font><font>（你还可以给你想要的价值）。</font><font>一个字符串可以用作一个原始图层。</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font class="">&gt;&gt;&gt; </font></font></span><span class="n"><font><font class="">IP </font></font></span><span class="p"><font><font class="">（）</font></font></span>
<span class="go"><font><font class="">&lt;IP |&gt; </font></font></span>
<span class="gp"><font><font class="">&gt;&gt;&gt; </font></font></span><span class="n"><font><font class="">IP </font></font></span><span class="p"><font><font class="">（）</font></font></span><span class="o"><font><font class="">/ </font></font></span><span class="n"><font><font class="">TCP </font></font></span><span class="p"><font><font class="">（）</font></font></span>
<span class="go"><font><font class="">&lt;IP FRAG = 0原= TCP | &lt;TCP | &gt;&gt; </font></font></span>
<span class="gp"><font><font class="">&gt;&gt;&gt; </font></font></span><span class="n"><font><font class="">以太</font></font></span><span class="p"><font><font class="">（）</font></font></span><span class="o"><font><font class="">/ </font></font></span><span class="n"><font><font class="">IP </font></font></span><span class="p"><font><font class="">（）</font></font></span><span class="o"><font><font class="">/ </font></font></span><span class="n"><font><font class="">TCP </font></font></span><span class="p"><font><font class="">（）</font></font></span>
<span class="go"><font><font class="">&lt;以太type = 0x800 | &lt;IP frag = 0 proto = TCP | &lt;TCP | &gt;&gt;&gt; </font></font></span>
<span class="gp"><font><font class="">&gt;&gt;&gt; </font></font></span><span class="n"><font><font class="">IP </font></font></span><span class="p"><font><font class="">（）</font></font></span><span class="o"><font><font class="">/ </font></font></span><span class="n"><font><font class="">TCP </font></font></span><span class="p"><font><font class="">（）</font></font></span><span class="o"><font><font class="">/ </font></font></span><span class="s"><font><font class="">“GET / HTTP / 1.0 </font></font></span><span class="se"><font><font class="">\ r \ n \ r \ n </font></font></span><span class="s"><font><font class="">” </font></font></span>
<span class="go"><font><font class="">&lt;IP frag = proto = TCP | &lt;TCP | &lt;Raw load ='GET / HTTP / 1.0 \ r \ n \ r \ n'| &gt;&gt;&gt; </font></font></span>
<span class="gp"><font><font class="">&gt;&gt;&gt;</font></font></span><span class="n"><font><font class="">Ether </font></font></span><span class="p"><font><font class="">（）</font></font></span><span class="o"><font><font class="">/ </font></font></span><span class="n"><font><font class="">IP </font></font></span><span class="p"><font><font class="">（）</font></font></span><span class="o"><font><font class="">/ </font></font></span><span class="n"><font><font class="">IP </font></font></span><span class="p"><font><font class="">（）</font></font></span><span class="o"><font><font class="">/ </font></font></span><span class="n"><font><font class="">UDP </font></font></span><span class="p"><font><font class="">（）</font></font></span>
<span class="go"><font><font class="">&lt;以太类型= 0x800 | &lt;IP frag = 0 proto = IP | &lt;IP frag = 0 proto = UDP | &lt;UDP | &gt;&gt;&gt;&gt; </font></font></span>
<span class="gp"><font><font class="">&gt;&gt;&gt; </font></font></span><span class="n"><font><font class="">IP </font></font></span><span class="p"><font><font class="">（</font></font></span><span class="n"><font><font class="">proto </font></font></span><span class="o"><font><font class="">= </font></font></span><span class="mi"><font><font class="">55 </font></font></span><span class="p"><font><font class="">）</font></font></span><span class="o"><font><font class="">/ </font></font></span><span class="n"><font><font class="">TCP </font></font></span><span class="p"><font><font class="">（）</font></font></span>
<span class="go"><font><font class="">&lt;IP frag = 0 proto = 55 | &lt;TCP | &gt;&gt;</font></font></span>
</pre></div>
</div>
<a class="reference external image-reference" href="./用法 - Scapy v2.1.1-dev文档_files/fieldsmanagement.png"><img alt="_images / fieldsmanagement.png" src="./用法 - Scapy v2.1.1-dev文档_files/fieldsmanagement.png" style="width: 779.4px; height: 181.8px;"></a>
<p><font><font class="">每个数据包可以建立或解剖（注意：在Python </font></font><tt class="docutils literal"><span class="pre"><font><font class="">_</font></font></span></tt><font><font class="">（下划线）是最新的结果）：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font></font></span><font><span class="n"><font>hexdump </font></span><span class="p"><font>（</font></span><span class="n"><font>a </font></span><span class="p"><font>）</font></span><span class="go"><font>00 02 15 37 A2 44 00 AE F3 52 AA D1 08 00 45 00 ... 7.D ... R .... E。</font></span><span class="go"><font>00 43 00 01 00 00 40 06 78 3C C0 A8 05 15 42 23 .C .... @。x &lt;.... B＃</font></span><span class="go"><font>FA 97 00 14 00 50 00 00 00 00 00 00 00 00 50 02 ... ..P ........ P上。</font></span><span class="go"><font>20 00 BB 39 00 00 47 45 54 20 2F 69 6E 64 65 78 ..9..GET /索引</font></span><span class="go"><font>2E 68 74 6D 6C 20 48 54 54 50 2F 31 2E 30 20 0A .html HTTP / 1.0。</font></span><span class="go"><font>0A。</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>b </font></span><span class="o"><font>= </font></span><span class="nb"><font>str </font></span><span class="p"><font>（</font></span><span class="n"><font>a </font></span><span class="p"><font>）</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>b </font></span><span class="go"><font>'\ x00 \ x02 \ x157 \ xa2D \ x00 \ xae \ xf3R \ xaa \ xd1 \ x08 \ x00E \ x00 \ x00 \ x00 \ x01 \ x00 \ x00 @ \ x06x &lt;</font></span></font><span class="nb"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span>
<span class="go"><font></font></span>
<span class="gp"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="gp"><font></font></span> <span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span><span class="o"><font></font></span><span class="s"><font></font></span><span class="se"><font></font></span><span class="s"><font></font></span>
<span class="gp"><font></font></span> <span class="n"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="gp"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="nb"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span>
<span class="gp"><font></font></span><span class="n"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="gp"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span>
<span class="gp"><font></font></span><span class="n"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
</pre></div>
</div>
<p><font><font>我们看到一个解剖的数据包已经填充了所有的字段。</font><font>这是因为我认为每个字段都有其原始字符串强加的值。</font><font>如果这太冗长，则hide_defaults（）方法将删除与默认值相同的每个字段：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>c </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>hide_defaults </font></font></span><span class="p"><font><font>（）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>c </font></font></span>
<span class="go"><font><font>&lt; </font></font></span>
<font><span class="n"><font>ether </font></span><span class="go"><font>dst = 00：0f：66：56：fa：d2 src = 00：ae：f3：52：aa：d1 type = 0x800 | &lt;IP ihl = 5L len = 67 </font></span></font><span class="go"><font><font>frag = proto = TCP chksum = 0x783c src = 192.168.5.21 dst = 66.35.250.151 | &lt;TCP dataofs = 5L </font></font></span>
<span class="go"><font><font>chksum = 0xbb39 options = [] | &lt;Raw load ='GET /index.html HTTP / 1.0 \ n \ n'|&gt; &gt;&gt;&gt;</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="reading-pcap-files">
<h3><font><font>阅读PCAP文件</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#reading-pcap-files" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p id="index-9"><font><font>您可以从pcap文件读取数据包并将其写入pcap文件。</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>a </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>rdpcap </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“/spare/captures/isakmp.cap” </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>a </font></font></span>
<span class="go"><font><font>&lt;isakmp.cap：UDP：721 TCP：0 ICMP：0其他：0&gt;</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="graphical-dumps-pdf-ps">
<h3><font><font>图形转储（PDF，PS）</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#graphical-dumps-pdf-ps" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p id="index-10"><font><font>如果您安装了PyX，则可以对数据包或数据包列表进行图形化的PostScript / PDF转储（请参阅下面的难看的PNG图像。PostScript / PDF的质量更好）...：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>a </font></font></span><span class="p"><font><font>[ </font></font></span><span class="mi"><font><font>423 </font></font></span><span class="p"><font><font>] </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>pdfdump </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>layer_shift </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>a </font></font></span><span class="p"><font><font>[ </font></font></span><span class="mi"><font><font>423 </font></font></span><span class="p"><font><font>] </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>psdump </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“/tmp/isakmp_pkt.eps” </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>layer_shift </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
<img alt="_images / isakmp_dump.png" src="./用法 - Scapy v2.1.1-dev文档_files/isakmp_dump.png">
<table border="1" class="docutils">
<colgroup>
<col width="23%">
<col width="77%">
</colgroup>
<thead valign="bottom">
<tr><th class="head"><font><font>命令</font></font></th>
<th class="head"><font><font>影响</font></font></th>
</tr>
</thead>
<tbody valign="top">
<tr><td><font><font>STR（PKT）</font></font></td>
<td><font><font>组装数据包</font></font></td>
</tr>
<tr><td><font><font>hexdump都（PKT）</font></font></td>
<td><font><font>有一个十六进制转储</font></font></td>
</tr>
<tr><td><font><font>LS（PKT）</font></font></td>
<td><font><font>具有字段值列表</font></font></td>
</tr>
<tr><td><font><font>pkt.summary（）</font></font></td>
<td><font><font>单行总结</font></font></td>
</tr>
<tr><td><font><font>pkt.show（）</font></font></td>
<td><font><font>对于分组的开发视图</font></font></td>
</tr>
<tr><td><font><font>pkt.show2（）</font></font></td>
<td><font><font>与显示相同，但​​在组装的数据包（例如计算校验和）</font></font></td>
</tr>
<tr><td><font><font>pkt.sprintf（）</font></font></td>
<td><font><font>填充包含字段值的格式字符串</font></font></td>
</tr>
<tr><td><font><font>pkt.decode_payload_as（）</font></font></td>
<td><font><font>改变了有效载荷的解码方式</font></font></td>
</tr>
<tr><td><font><font>pkt.psdump（）</font></font></td>
<td><font><font>绘制一个PostScript图解释解剖</font></font></td>
</tr>
<tr><td><font><font>pkt.pdfdump（）</font></font></td>
<td><font><font>绘制PDF解释</font></font></td>
</tr>
<tr><td><font><font>pkt.command（）</font></font></td>
<td><font><font>返回可以生成数据包的Scapy命令</font></font></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="generating-sets-of-packets">
<h3><font><font>生成数据包集</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#generating-sets-of-packets" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p><font><font>目前我们只生成了一个数据包。</font><font>让我们看看如何轻松地指定数据包集。</font><font>整个数据包的每个字段（以前的层）可以是一个集合。</font><font>这意味着定义了一组使用所有字段之间的一种笛卡尔乘积产生的数据包。</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>a </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“www.slashdot.org/30” </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>a </font></font></span>
<span class="go"><font><font>&lt;IP dst = Net（'www.slashdot.org/30'）|&gt; </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="p"><font><font>[ </font></font></span><span class="n"><font><font>p </font></font></span> <span class="k"><font><font>for </font></font></span> <span class="n"><font><font>a </font></font></span> <span class="ow"><font><font>in </font></font></span> <span class="n"><font><font>a </font></font></span><span class="p"><font><font>] </font></font></span>
<span class="go"><font><font>[&lt;IP dst = 66.35.250.148 |&gt;，&lt;IP dst = 66.35.250.149 |&gt;，</font></font></span>
<span class="go"><font><font>&lt;IP dst = 66.35.250.150 |&gt;，&lt;IP dst = 66.35.250.151 |&gt;] </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>b </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>ttl </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>[ </font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>2 </font></font></span><span class="p"><font><font>，（</font></font></span><span class="mi"><font><font>5 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>9 </font></font></span><span class="p"><font><font>）]）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>b </font></font></span>
<span class="go"><font><font>&lt;IP TTL = [1，2，（5,9）] |&gt; </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt;</font></font></span><span class="p"><font><font>[ </font></font></span><span class="n"><font><font>p </font></font></span> <span class="k"><font><font>为</font></font></span> <span class="n"><font><font>p </font></font></span> <span class="ow"><font><font>在</font></font></span> <span class="n"><font><font>b </font></font></span><span class="p"><font><font>] </font></font></span>
<span class="go"><font><font>[&lt;IP TTL = 1 |&gt;，&lt;IP TTL = 2 |&gt;，&lt;IP TTL = 5 |&gt;，&lt;IP TTL = 6 |&gt;，</font></font></span>
<span class="go"><font><font>&lt;IP TTL = 7 |&gt;，&lt;IP TTL = 8 |&gt;，&lt;IP TTL = 9 |&gt;] </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ç </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DPORT </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>[ </font></font></span><span class="mi"><font><font>80 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>443 </font></font></span><span class="p"><font><font>]）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="p"><font><font>[ </font></font></span><span class="n"><font><font>p </font></font></span> <span class="k"><font><font>为</font></font></span> <span class="n"><font><font>p </font></font></span> <span class="ow"><font><font>在</font></font></span> <span class="n"><font><font>一个</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>ç </font></font></span><span class="p"><font><font>] </font></font></span>
<span class="go"><font><font>[&lt;IP FRAG = 0原= TCP dst = 66.35.250.148 | &lt;TCP dport = 80 | &gt;&gt;，</font></font></span>
<span class="go"><font><font>&lt;IP frag = 0 proto = TCP dst = 66.35.250.148 | &lt;TCP dport = 443 | &gt;&gt;，</font></font></span>
<span class="go"><font><font>&lt;IP frag = 0 proto = TCP dst = 66.35。 250.149 | &lt;TCP dport = 80 | &gt;&gt;，</font></font></span>
<span class="go"><font><font>&lt;IP frag = 0 proto = TCP dst = 66.35.250.149 | &lt;TCP dport = 443 | &gt;&gt;， </font></font></span>
<span class="go"><font><font>&lt;IP frag = 0 proto = TCP dst = 66.35.250.150 | &lt;TCP dport = 80 | &gt;&gt;，</font></font></span>
<span class="go"><font><font>&lt;IP frag = 0 proto = TCP dst = 66.35.250.150 | &lt;TCP dport = 443 | &gt;&gt;，</font></font></span>
<span class="go"><font><font>&lt;IP frag = 0 proto = TCP dst = 66.35.250.151 | &lt;TCP dport = 80 | &gt;&gt;，</font></font></span>
<span class="go"><font><font>&lt;IP frag = 0 proto = TCP dst = 66.35.250.151 | &lt;TCP dport = 443 | &gt;&gt;]</font></font></span>
</pre></div>
</div>
<p><font><font>一些操作（如从数据包构建字符串）不能在一组数据包上工作。</font><font>在这些情况下，如果您忘记展开您的数据包，则只有您忘记生成的列表中的第一个元素将被用于汇编数据包。</font></font></p>
<table border="1" class="docutils">
<colgroup>
<col width="21%">
<col width="79%">
</colgroup>
<thead valign="bottom">
<tr><th class="head"><font><font>命令</font></font></th>
<th class="head"><font><font>影响</font></font></th>
</tr>
</thead>
<tbody valign="top">
<tr><td><font><font>概要（）</font></font></td>
<td><font><font>显示每个数据包的摘要列表</font></font></td>
</tr>
<tr><td><font><font>nsummary（）</font></font></td>
<td><font><font>与以前一样，具有数据包号</font></font></td>
</tr>
<tr><td><font><font>对话（）</font></font></td>
<td><font><font>显示会话图</font></font></td>
</tr>
<tr><td><font><font>显示（）</font></font></td>
<td><font><font>显示优先表示（通常为nsummary（））</font></font></td>
</tr>
<tr><td><font><font>过滤（）</font></font></td>
<td><font><font>返回用lambda函数过滤的数据包列表</font></font></td>
</tr>
<tr><td><font><font>hexdump都可以（）</font></font></td>
<td><font><font>返回所有数据包的hexdump</font></font></td>
</tr>
<tr><td><font><font>hexraw（）</font></font></td>
<td><font><font>返回所有数据包的Raw层的hexdump</font></font></td>
</tr>
<tr><td><font><font>填充（）</font></font></td>
<td><font><font>返回带填充的数据包的hexdump</font></font></td>
</tr>
<tr><td><font><font>nzpadding（）</font></font></td>
<td><font><font>返回具有非零填充的数据包的hexdump</font></font></td>
</tr>
<tr><td><font><font>情节（）</font></font></td>
<td><font><font>绘制应用于数据包列表的lambda函数</font></font></td>
</tr>
<tr><td><font><font>make table（）</font></font></td>
<td><font><font>根据lambda函数显示一个表</font></font></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sending-packets">
<h3><font><font>发送数据包</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#sending-packets" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p id="index-11"><font><font>现在我们知道如何操纵数据包。</font><font>我们来看看如何发送。</font><font>send（）函数将在第3层发送数据包。也就是说，它将为您处理路由和第2层。</font><font>sendp（）函数将在第2层工作。您可以选择正确的接口和正确的链路层协议。</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>send </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“1.2.3.4” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>ICMP </font></font></span><span class="p"><font><font>（））</font></font></span>
<span class="go"><font><font>。</font></font></span>
<span class="go"><font><font>发1包。</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>sendp </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>以太</font></font></span><span class="p"><font><font>（）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“1.2.3.4” </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>TTL </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>（</font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>4 </font></font></span><span class="p"><font><font>）），</font></font></span> <span class="n"><font><font>IFACE </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“eth1的” </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>.... </font></font></span>
<span class="go"><font><font>发送4个包。</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>sendp </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“我在以太网上旅行” </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>iface </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“eth1” </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>loop </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>inter </font></font></span><span class="o"><font><font>= </font></font></span><span class="mf"><font><font>0.2 </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>............... ^ C </font></font></span>
<span class="go"><font><font>发16个数据包。</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>sendp </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>rdpcap </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“/ TMP / pcapfile” </font></font></span><span class="p"><font><font>））</font></font></span> <span class="c"><font><font>＃tcpreplay </font></font></span>
<span class="go"><font><font>........... </font></font></span>
<span class="go"><font><font>发送11个包。</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="fuzzing">
<h3><font><font>模糊</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#fuzzing" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p id="index-12"><font><font>函数fuzz（）能够通过值为随机的对象更改不被计算的任何默认值（如校验和），并且其类型适用于该字段。</font><font>这样可以快速构建模糊模板并循环发送。</font><font>在下面的例子中，IP层是正常的，UDP层和NTP层是模糊的。</font><font>UDP校验和将是正确的，UDP目标端口将由NTP重载为123，并且NTP版本将被强制为4.所有其他端口将被随机化：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>send </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“target” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>fuzz </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>UDP </font></font></span><span class="p"><font><font>（）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>NTP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>version </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>4 </font></font></span><span class="p"><font><font>）），</font></font></span><span class="n"><font><font>loop </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>................ ^ C </font></font></span>
<span class="go"><font><font>发16包</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="send-and-receive-packets-sr">
<h3><font><font>发送和接收数据包（sr）</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#send-and-receive-packets-sr" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p id="index-13"><font><font>现在，让我们尝试一些有趣的事情。</font><font>sr（）函数用于发送数据包和接收答案。</font><font>该函数返回一些数据包和答案以及未应答的数据包。</font><font>函数sr1（）是一个变体，只返回一个应答数据包（或数据包集）发送的数据包。</font><font>报文必须是3层报文（IP，ARP等）。</font><font>函数srp（）对第2层数据包（以太网，802.3等）执行相同操作。</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>p </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>sr1 </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“www.slashdot.org” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>ICMP </font></font></span><span class="p"><font><font>（）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="s"><font><font>“XXXXXXXXXXX” </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>开始发射：</font></font></span>
<span class="go"><font><font>...完成发送1个数据包。</font></font></span>
<span class="go"><font><font>* </font></font></span>
<span class="go"><font><font>收到5个数据包，得到1个答案，剩余0个数据包</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>p </font></font></span>
<span class="go"><font><font>&lt;IP版本= 4L ihl = 5L tos = 0x0 len = 39 id = 15489 flags = frag = 0L ttl = 42 proto = ICMP </font></font></span>
<span class="go"><font><font>chksum = 0x51dd src = 66.35.250.151 dst = 192.168.5.21 options =''| &lt;ICMP type = echo-r​​eply </font></font></span>
<span class="go"><font><font>code = 0 chksum = 0xee45 id = 0x0 seq = 0x0 | &lt;Raw load ='XXXXXXXXXXX' </font></font></span>
<span class="go"><font><font>| &lt;Padding load ='\ x00 \ x00 \ x00 \ x00'| &gt;&gt;&gt;&gt; </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>p </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>show </font></font></span><span class="p"><font><font>（）</font></font></span>
<span class="go"><font><font>--- [IP] --- </font></font></span>
<span class="go"><font><font>version = 4L </font></font></span>
<span class="go"><font><font>ihl = 5L </font></font></span>
<span class="go"><font><font>tos = 0x0 </font></font></span>
<span class="go"><font><font>len = 39 </font></font></span>
<span class="go"><font><font>id = 15489 </font></font></span>
<span class="go"><font><font>flags = </font></font></span>
<span class="go"><font><font>frag = 0L </font></font></span>
<span class="go"><font><font>ttl = 42 </font></font></span>
<span class="go"><font><font>proto = ICMP </font></font></span>
<span class="go"><font><font>chksum = 0x51dd </font></font></span>
<span class="go"><font><font>src = 66.35.250.151 </font></font></span>
<span class="go"><font><font>dst = 192.168。 5.21 </font></font></span>
<span class="go"><font><font>options ='' </font></font></span>
<span class="go"><font><font>--- [ICMP] --- </font></font></span>
<span class="go"><font><font>   type = echo-r​​eply </font></font></span>
<span class="go"><font><font>   code = 0 </font></font></span>
<span class="go"><font><font>   chksum = 0xee45 </font></font></span>
<span class="go"><font><font>   id = 0x0 </font></font></span>
<span class="go"><font><font>   seq = 0x0 </font></font></span>
<span class="go"><font><font>--- [Raw] --- </font></font></span>
<span class="go"><font><font>      load ='XXXXXXXXXXX' </font></font></span>
<span class="go"><font><font>--- [Padding ] --- </font></font></span>
<span class="go"><font><font>         load ='\ x00 \ x00 \ x00 \ x00'</font></font></span>
</pre></div>
</div>
<p id="index-14"><font><font>DNS查询（</font></font><tt class="docutils literal"><span class="pre"><font><font>rd</font></font></span></tt><font><font> =需要递归）。</font><font>主机192.168.5.1是我的DNS服务器。</font><font>注意来自我的Linksys的非空填充具有以太网漏洞：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>sr1 </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168.5.1” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>UDP </font></font></span><span class="p"><font><font>（）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>DNS </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>rd </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>qd </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>DNSQR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>qname </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“www.slashdot.org” </font></font></span><span class="p"><font><font>）））</font></font></span>
<span class="go"><font><font>开始发射：</font></font></span>
<span class="go"><font><font>完成发送1个数据包。</font></font></span>
<span class="go"><font><font>.. * </font></font></span>
<span class="go"><font><font>接收到3个数据包，得到1个答案，剩余0个数据包</font></font></span>
<span class="go"><font><font>&lt;IP版本= 4L ihl = 5L tos = 0x0 len = 78 id = 0 flags = DF frag = 0L ttl = 64 proto = UDP chksum = 0xaf38 </font></font></span>
<span class="go"><font><font>src = 192.168。 5.1 dst = 192.168.5.21 options =''| &lt;UDP sport = 53 dport = 53 len = 58 chksum = 0xd55d </font></font></span>
<span class="go"><font><font>| &lt; </font></font></span>
<span class="go"><font><font>DNS id = 0 qr = 1L opcode = QUERY aa = 0L tc = 0L rd = 1L ra = 1L z = 0L rcode = ok qdcount = 1 ancount = 1 nscount = 0 arcount = 0 qd = &lt;DNSQR qname ='www.slashdot .org等“。</font><font>qtype = A qclass = IN |&gt; </font></font></span>
<span class="go"><font><font>an = &lt;DNSRR rrname ='www.slashdot.org。</font><font>type = A rclass = IN ttl = 3560L rdata = '66 .35.250.151'|&gt; </font></font></span>
<span class="go"><font><font>ns = 0 ar = 0 | &lt;padding load ='\ xc6 \ x94 \ xc7 \ xeb'| &gt;&gt;&gt;&gt;</font></font></span>
</pre></div>
</div>
<p><font><font>“send'n'receive”功能家庭是治疗的核心。</font><font>他们返回两个列表。</font><font>第一个元素是一对夫妇列表（包发送，应答），第二个元素是未应答包的列表。</font><font>这两个元素是列表，但是它们被一个对象包围以便更好地呈现它们，并为他们提供一些最常需要的操作的方法：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>SR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168.8.1” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DPORT </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>[ </font></font></span><span class="mi"><font><font>21 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>22 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>23 </font></font></span><span class="p"><font><font>]））</font></font></span>
<span class="go"><font><font>接收到的6个封包，得到了3个答案，其余0的数据包</font></font></span>
<span class="go"><font><font>（&lt;结果：UDP：0 TCP：3 ICMP：0其他：0&gt;，&lt;未回答：UDP：0 TCP：0 ICMP：0其他：0&gt;）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>_ </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>summary </font></font></span><span class="p"><font><font>（）</font></font></span>
<span class="go"><font><font>IP / TCP 192.168.8.14:20&gt; 192.168.8.1:21 S ==&gt; Ether / IP / TCP 192.168.8.1:21&gt; 192.168.8.14:20 RA / Padding </font></font></span>
<span class="go"><font><font>IP / TCP 192.168.8.14:20&gt; 192.168 .8.1：22 S ==&gt;</font></font></span>
<span class="go"><font></font></span>
</pre></div>
</div>
<p><font><font>如果响应速度有限，可以使用inter参数指定两个数据包之间等待的时间间隔。</font><font>如果某些数据包丢失或者指定的时间间隔不够，您可以重新发送所有未应答的数据包，无论是通过再次调用该函数，直接使用未应答的列表，还是通过指定重试参数。</font><font>如果重试是3，scapy将尝试重新发送未应答的数据包3次。</font><font>如果重试是-3，scapy将重新发送未应答的数据包，直到没有更多的答案给同一组未应答的数据包连续3次。</font><font>超时参数指定最后一个数据包发送后等待的时间：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>SR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“172.20.29.5/30” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DPORT </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>[ </font></font></span><span class="mi"><font><font>21 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>22 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>23 </font></font></span><span class="p"><font><font>]），</font></font></span><span class="n"><font><font>间</font></font></span><span class="o"><font><font>= </font></font></span><span class="mf"><font><font>0.5 </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>重试</font></font></span><span class="o"><font><font>= - </font></font></span><span class="mi"><font><font>2 </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>超时</font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>开始发射：</font></font></span>
<span class="go"><font><font>成品发送12包 </font></font></span>
<span class="go"><font><font>开始发射：</font></font></span>
<span class="go"><font><font>完成发送9个数据包。</font></font></span>
<span class="go"><font><font>开始发射：</font></font></span>
<span class="go"><font><font>完成发送9个数据包。</font></font></span>

<span class="go"><font><font>收到100个数据包，得到3个答案，剩下9个数据包</font></font></span>
<span class="go"><font><font>（&lt;结果：UDP：0 TCP：3 ICMP：0其他：0&gt;，&lt;未回答：UDP：0 TCP：9 ICMP：0其他：0&gt;）</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="syn-scans">
<h3><font><font>SYN扫描</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#syn-scans" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p id="index-15"><font><font>可以通过从Scapy的提示符执行以下命令来初始化经典SYN Scan：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>sr1 </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“72.14.207.99” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dport </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>80 </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>flags </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“S” </font></font></span><span class="p"><font><font>））</font></font></span>
</pre></div>
</div>
<p><font><font>以上将向Google的80端口发送一个SYN数据包，并在接收到一个响应后退出：</font></font></p>
<div class="highlight-python"><pre><font><font>开始发射：</font></font><font><font>
发送1个数据包。</font></font><font><font>
* </font></font><font><font>
接收到2个数据包，得到1个答案，剩余0个数据包</font></font><font><font>
&lt;IP版本= 4L ihl = 5L tos = 0x20 len = 44 id = 33529 flags = frag = 0L ttl = 244 </font></font><font><font>
proto = TCP chksum = 0x6a34 src = 72.14.207.99 dst = 192.168.1.100 options = // | </font></font><font><font>
&lt;TCP sport = www dport = ftp-data seq = 2487238601L ack = 1 dataofs = 6L reserved = 0L </font></font><font><font>
flags = SA window = 8190 chksum = 0xcdc7 urgptr = 0 options = [（'MSS'，536）] | </font></font><font><font>
&lt;Padding load ='V \ xf7'| &gt;&gt;&gt;</font></font></pre>
</div>
<p><font><font>从上面的输出，我们可以看到Google返回的“SA”或SYN-ACK标志指示一个打开的端口。</font></font></p>
<p><font><font>使用符号来扫描系统上的端口400到443：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>SR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168.1.1” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>运动</font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>666 </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>DPORT </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>（</font></font></span><span class="mi"><font><font>440 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>443 </font></font></span><span class="p"><font><font>），</font></font></span><span class="n"><font><font>标志</font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“S” </font></font></span><span class="p"><font><font>））</font></font></span>
</pre></div>
</div>
<p><font><font>要么</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>SR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168.1.1” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>运动</font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>RandShort </font></font></span><span class="p"><font><font>（），</font></font></span><span class="n"><font><font>DPORT </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>[ </font></font></span><span class="mi"><font><font>440 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>441 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>442 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>443 </font></font></span><span class="p"><font><font>]，</font></font></span><span class="n"><font><font>标志</font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“S” </font></font></span><span class="p"><font><font>））</font></font></span>
</pre></div>
</div>
<p><font><font>为了快速查看响应，只需要收集收集的数据包的摘要：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>_ </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>summary </font></font></span><span class="p"><font><font>（）</font></font></span>
<span class="go"><font><font>IP / TCP 192.168.1.100:ftp-data&gt; 192.168.1.1:440 S ======&gt; IP / TCP 192.168.1.1:440&gt; 192.168.1.100:ftp-data RA / Padding </font></font></span>
<span class="go"><font><font>IP / TCP 192.168 .1.100：ftp-data&gt; 192.168.1.1:441 S ======&gt; IP / TCP 192.168.1.1:441&gt; 192.168.1.100:ftp-data RA / Padding </font></font></span>
<span class="go"><font><font>IP / TCP 192.168.1.100:ftp-data&gt; 192.168.1.1:442 S ======&gt; IP / TCP 192.168.1.1:442&gt; 192.168.1.100:ftp-data RA / Padding </font></font></span>
<span class="go"><font><font>IP / TCP 192.168.1.100:ftp-data&gt; 192.168.1.1:https S = =====&gt; IP / TCP 192.168.1.1:https&gt; 192.168.1.100:ftp-data SA / Padding</font></font></span>
</pre></div>
</div>
<p><font><font>以上将显示应答探针的刺激/响应对。</font><font>我们可以使用简单的循环仅显示我们感兴趣的信息：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>概要</font></font></span><span class="p"><font><font>（</font></font></span> <span class="k"><font><font>拉姆达</font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R </font></font></span><span class="p"><font><font>）：</font></font></span> <span class="n"><font><font>- [R </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>的sprintf </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“％TCP.sport％</font></font></span><span class="se"><font><font>\吨</font></font></span><span class="s"><font><font>％TCP.flags％” ）</font></font></span><font><span class="p"><font>）</font></span></font><span class="p"><font><font> </font></font></span> <font><span class="go"><font>440 RA </font></span><span class="go"><font>441 RA </font></span><span class="go"><font>442 RA </font></span><span class="go"><font>HTTPS SA</font></span></font><span class="p"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
</pre></div>
</div>
<p><font><font>更好的是，可以使用</font></font><tt class="docutils literal"><span class="pre"><font><font>make_table（）</font></font></span></tt><font><font>函数来</font><font>构建一个表，</font><font>以显示有关多个目标的信息：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ANS </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>SR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>[ </font></font></span><span class="s"><font><font>“192.168.1.1” </font></font></span><span class="p"><font><font>，</font></font></span><span class="s"><font><font>“yahoo.com” </font></font></span><span class="p"><font><font>，</font></font></span><span class="s"><font><font>“slashdot.org” </font></font></span><span class="p"><font><font>]）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DPORT </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>[ </font></font></span><span class="mi"><font><font>22 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>80 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>443 </font></font></span><span class="p"><font><font>]，</font></font></span><span class="n"><font><font>标志</font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“S “ </font></font></span><span class="p"><font><font>））</font></font></span>
<span class="go"><font><font>开始发射：</font></font></span>
<span class="go"><font><font>....... *。** .......完成发送9个数据包。</font></font></span>
<span class="go"><font><font>**。*。* .. * .................. </font></font></span>
<span class="go"><font><font>收到362个包，得到8个答案，剩下1个包</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>make_table </font></font></span><span class="p"><font><font>（</font></font></span>
<span class="gp"><font><font>... </font></font></span>   <font><span class="n"><font>r </font></span><span class="o"><font>。</font></span><span class="n"><font>sprintf </font></span><span class="p"><font>（</font></span><span class="s"><font>“{TCP：％TCP.flags％} {ICMP：％IP.src </font></span><span class="si"><font>％ - ％</font></span><span class="s"><font>ICMP.type％}” </font></span><span class="p"><font>）））</font></span><span class="go"><font>    66.35.250.150 192.168.1.1 216.109.112.135 </font></span><span class="go"><font>22 66.35.250.150  -  dest-unreach RA  - </font></span><span class="go"><font>80 SA RA SA </font></span><span class="go"><font>443 SA SA SA </font></span><span class="n"><font>r </font></span><span class="o"><font>。</font></span><span class="n"><font>sprintf </font></span><span class="p"><font>（</font></span><span class="s"><font>“{TCP：％TCP.flags％} {ICMP：％IP.src </font></span><span class="si"><font>％ - ％</font></span><span class="s"><font>ICMP.type％}” </font></span><span class="p"><font>）））</font></span><span class="go"><font>66.35.250.150 192.168.1.1 216.109.112.135 </font></span><span class="go"><font>22 66.35.250.150  -  dest-unreach RA  - </font></span><span class="go"><font>80 SA RA SA </font></span><span class="go"><font>443 SA SA SA</font></span></font><span class="k"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span> <span class="p"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span> <span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span>
<span class="gp"><font></font></span>   <span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span><span class="s"><font></font></span><span class="si"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
</pre></div>
</div>
<p><font><font>如果接收到ICMP数据包作为响应而不是预期的TCP，则上述示例甚至打印ICMP错误类型。</font></font></p>
<p><font><font>对于较大的扫描，我们可能有兴趣仅显示某些响应。</font><font>下面的例子只显示设置了“SA”标志的数据包：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>nsummary </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>lfilter </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="k"><font><font>拉姆达</font></font></span> <span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R </font></font></span><span class="p"><font><font>）：</font></font></span> <span class="n"><font><font>- [R </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>的sprintf </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“％TCP.flags％” </font></font></span><span class="p"><font><font>）</font></font></span> <span class="o"><font><font>== </font></font></span> <span class="s"><font><font>“SA” </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>0003的IP / TCP 192.168.1.100:ftp_data&gt; 192.168.1.1:https小号===== =&gt; IP / TCP 192.168.1.1:https&gt; 192.168.1.100:ftp_data SA</font></font></span>
</pre></div>
</div>
<p><font><font>如果我们想对响应进行一些专家分析，我们可以使用以下命令来指出哪些端口是打开的：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>摘要</font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>lfilter </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="k"><font><font>拉姆达</font></font></span> <span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R </font></font></span><span class="p"><font><font>）：</font></font></span> <span class="n"><font><font>- [R </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>的sprintf </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“％TCP.flags％” </font></font></span><span class="p"><font><font>）</font></font></span> <span class="o"><font><font>== </font></font></span> <span class="s"><font><font>“SA” </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>PRN </font></font></span><span class="o"><font><font>= </font></font></span><span class="k"><font><font>拉姆达</font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R </font></font></span><span class="p"><font><font>）：</font></font></span><span class="n"><font><font>- [R </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>的sprintf </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“％TCP.sport </font></font></span><span class="si"><font><font>％I </font></font></span><span class="s"><font><font>小号打开“ </font></font></span><span class="p"><font><font>））</font></font></span>
<span class="go"><font><font>https打开</font></font></span>
</pre></div>
</div>
<p><font><font>再次，对于较大的扫描，我们可以构建一个开放端口表：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>过滤器</font></font></span><span class="p"><font><font>（</font></font></span><span class="k"><font><font>拉姆达</font></font></span> <span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R </font></font></span><span class="p"><font><font>）：</font></font></span><span class="n"><font><font>TCP </font></font></span> <span class="ow"><font><font>在</font></font></span> <span class="n"><font><font>ř </font></font></span> <span class="ow"><font><font>和</font></font></span> <span class="n"><font><font>- [R </font></font></span><span class="p"><font><font>[ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>] </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>标志</font></font></span><span class="o"><font><font>＆</font></font></span><span class="mi"><font><font>2 </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>make_table </font></font></span><span class="p"><font><font>（</font></font></span><span class="k"><font><font>拉姆达</font></font></span> <span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>[R </font></font></span><span class="p"><font><font>）：</font></font></span>
<span class="gp"><font><font>... </font></font></span>            <span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>DST </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>小号</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>DPORT </font></font></span><span class="p"><font><font>，</font></font></span> <span class="s"><font><font>“X” </font></font></span><span class="p"><font><font>））</font></font></span>
<span class="go"><font><font>    66.35.250.150 192.168.1.1 216.109.112.135 </font></font></span>
<span class="go"><font><font>80 X - X </font></font></span>
<span class="go"><font><font>443 XXX</font></font></span>
</pre></div>
</div>
<p><font><font>如果上述所有方法都不够，Scapy包括一个report_ports（）函数，它不仅可以自动执行SYN扫描，还可以生成一个收集结果的LaTeX输出：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>report_ports </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“192.168.1.1” </font></font></span><span class="p"><font><font>，（</font></font></span><span class="mi"><font><font>440 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>443 </font></font></span><span class="p"><font><font>））</font></font></span>
<span class="go"><font><font>开始发射：</font></font></span>
<span class="go"><font><font>... * **成品发送4个包。</font></font></span>
<span class="go"><font><font>* </font></font></span>
<span class="go"><font><font>收到8个数据包，得到4个答案，剩下0个数据包</font></font></span>
<span class="go"><font><font>'\\ begin {tabular} {| r | l | l |} \ n \\ hline \ nhttps＆open＆SA \\\\\ n \\ hline \ n440 </font></font></span>
<span class="go"><font><font>关闭＆TCP RA \\\\\ n441＆closed＆TCP RA \\\\\ n442＆closed＆</font></font></span>
<span class="go"><font><font>TCP RA \\\\\ n \\ hline \ n \\ hline \ n \\ end {tabular} \ N”</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="tcp-traceroute">
<h3><font><font>TCP跟踪路由</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#tcp-traceroute" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p id="index-16"><font><font>TCP跟踪路由：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ANS </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>SR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>目标</font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>TTL </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>（</font></font></span><span class="mi"><font><font>4 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>25 </font></font></span><span class="p"><font><font>），</font></font></span><span class="nb"><font><font>ID </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>RandShort </font></font></span><span class="p"><font><font>（））</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>标志</font></font></span><span class="o"><font><font>= </font></font></span><span class="mh"><font><font>0×2 </font></font></span><span class="p"><font><font>））</font></font></span>
<span class="go"><font><font>*****。******。 *。*** .. *。**完成发送22个数据包。</font></font></span>
<span class="go"><font><font>*** ... </font></font></span>
<span class="go"><font><font>收到33个包，得到21个答案，剩下1个数据包</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="k"><font><font>为</font></font></span> <span class="n"><font><font>snd </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>rcv </font></font></span> <span class="ow"><font><font>在</font></font></span> <span class="n"><font><font>ans </font></font></span><span class="p"><font><font>：</font></font></span>
<span class="gp"><font><font>... </font></font></span>    <span class="k"><font><font>打印</font></font></span> <span class="n"><font><font>snd </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>ttl </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>rcv </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font></font></span><span class="p"><font></font></span> <span class="nb"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span> <span class="n"><font></font></span><span class="p"><font></font></span>
<span class="gp"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
</pre></div>
</div>
<p><font><font>请注意，TCP跟踪路由和其他一些高级功能已经被编码：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>lsc </font></font></span><span class="p"><font><font>（）</font></font></span>
<span class="go"><font><font>sr：在第3层发送和接收数据包</font></font></span>
<span class="go"><font><font>sr1：在第3层发送数据包，并只返回第一个答案</font></font></span>
<span class="go"><font><font>srp：在第2层</font></font></span>
<span class="go"><font><font>发送和接收数据包srp1：</font></font></span>
<font><span class="go"><font>在第2层</font></span><span class="go"><font>发送和接收数据包，并只返回第一个答案</font></span></font><span class="go"><font><font>srloop：在第3层循环发送一个数据包，每次</font></font></span>
<span class="go"><font><font>srploop </font></font></span>
<font><span class="go"><font>打印答案</font></span><span class="go"><font>：在第2层循环发送一个数据包，每次</font></span></font><span class="go"><font><font>sniff </font></font></span>
<font><span class="go"><font>打印答案</font></span><span class="go"><font>：sniff packets </font></span></font><span class="go"><font><font>p0f：被动操作系统指纹：哪个OS发出这个TCP SYN ？</font></font></span>
<span class="go"><font><font>arpcachepoison：毒药目标的缓存与（你的MAC，受害者的IP）夫妇</font></font></span>
<span class="go"><font><font>发送：发送数据包在第3层</font></font></span>
<span class="go"><font><font>sendp：</font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="configuring-super-sockets">
<h3><font><font>配置超级套接字</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#configuring-super-sockets" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p id="index-17"><font><font>发送报文和接收的过程相当复杂。</font><font>当我想使用PF_PACKET接口来浏览netfilter时，我还需要实现一个ARP堆栈和ARP缓存以及一个LL堆栈。</font><font>好吧，它似乎在以太网和PPP接口上工作，但我不保证任何东西。</font><font>无论如何，我使用一种超级插座，这意味着您可以轻松地切换IO层，并使用PF_INET / SOCK_RAW，或者在级别2使用PF_PACKET（给出LL标头（以太网，...）和给自己的mac地址，...）。</font><font>我刚刚添加了一个使用libdnet和libpcap的超级套接字，这样它应该是可移植的：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>CONF </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>L3socket </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>L3dnetSocket </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>conf </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>L3listen </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>L3pcapListenSocket</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="sniffing">
<h3><font><font>嗅觉</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#sniffing" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p id="index-18"><font><font>我们可以轻松捕获一些数据包，甚至可以克隆tcpdump或tethereal。</font><font>如果没有接口，每个接口都会发出嗅探：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span> <span class="n"><font><font>sniff </font></font></span><span class="p"><font><font>（</font></font></span><span class="nb"><font><font>filter </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“icmp and host 66.35.250.151” </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>count </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>2 </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>&lt;Sniffed：UDP：0 TCP：0 ICMP：2其他：0&gt; </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span> <span class="n"><font><font>a </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>_ </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span> <span class="n"><font><font>a </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>nsummary </font></font></span><span class="p"><font><font>（）</font></font></span>
<span class="go"><font><font>0000 Ether / IP / ICMP 192.168.5.21 echo-r​​equest 0 / Raw </font></font></span>
<span class="go"><font><font>0001 Ether / IP / ICMP 192.168.5.21 echo-r​​equest 0 / Raw </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span> <span class="n"><font><font>a </font></font></span><span class="p"><font><font>[ </font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>] </font></font></span>
<span class="go"><font><font>&lt; </font></font></span>
<font><span class="go"><font>ether </font></span><span class="go"><font>dst = 00：ae：f3： 52：aa：d1 src = 00：02：15：37：a2：44 type = 0x800 | &lt;IP version = 4L </font></span></font><span class="go"><font><font>ihl = 5L tos = 0x0 len = 84 id = 0 flags = DF frag = 0L ttl = 64 proto = ICMP chksum = 0x3831 </font></font></span>
<span class="go"><font><font>src = 192.168.5.21 dst = 66.35.250.151 options =''</font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="gp"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span> <span class="n"><font></font></span><span class="o"><font></font></span><span class="k"><font></font></span> <span class="n"><font></font></span><span class="p"><font></font></span> <span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="gp"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span> <span class="n"><font></font></span><span class="o"><font></font></span><span class="k"><font></font></span> <span class="n"><font></font></span><span class="p"><font></font></span> <span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
</pre></div>
</div>
<p><font><font>为了更好地控制显示的信息，我们可以使用</font></font><tt class="docutils literal"><span class="pre"><font><font>sprintf（）</font></font></span></tt><font><font>函数：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>PKTS </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>嗅探</font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>PRN </font></font></span><span class="o"><font><font>= </font></font></span><span class="k"><font><font>拉姆达</font></font></span> <span class="n"><font><font>X </font></font></span><span class="p"><font><font>：</font></font></span><span class="n"><font><font>X </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>的sprintf </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“{IP：％IP.src％ - &gt;％IP.dst％</font></font></span><span class="se"><font><font>\ n </font></font></span><span class="s"><font><font>} {原材料：％Raw.load％</font></font></span><span class="se"><font><font>\ n </font></font></span><span class="s"><font><font>}” </font></font></span><span class="p"><font><font>））</font></font></span>
<span class="go"><font><font>192.168 .1.100  - &gt; 64.233.167.99 </font></font></span>

<span class="go"><font><font>64.233.167.99  - &gt; 192.168.1.100 </font></font></span>

<span class="go"><font><font>192.168.1.100  - &gt; 64.233.167.99 </font></font></span>

<span class="go"><font><font>192.168.1.100  - &gt; 64.233.167.99'GET </font></font></span>
<span class="go"><font><font>/ HTTP / 1.1 \ r \ nHost：64.233.167.99 \ r \ nUser-代理：Mozilla / 5.0 </font></font></span>
<span class="go"><font><font>（X11; U; Linux i686; en-US; rv：1.8.1.8）Gecko / 20071022 Ubuntu / 7.10（gutsy）</font></font></span>
<span class="go"><font><font>Firefox / 2.0.0.8 \ r \ n接受：text / xml，application / xml， application / xhtml + xml，</font></font></span>
<span class="go"><font><font>text / html; q = 0.9，text / plain; q = 0.8，image / png，* / *; q = 0.5 \ r \ n接受语言：</font></font></span>
<span class="go"><font><font>en-us，en; q = 0.5 \ r \ n接受编码：gzip，deflate \ r \ nAccept-Charset：</font></font></span>
<span class="go"><font><font>ISO-8859-1，utf-8; q = 0.7，*; q = 0.7 \ r \活着：300 \ r \ n连接：</font></font></span>
<span class="go"><font><font>keep-alive \ r \ nCache-Control：max-age = 0 \ r \ n \ r \ n'</font></font></span>
</pre></div>
</div>
<p><font><font>我们可以嗅探和做被动的OS指纹：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>p </font></font></span>
<span class="go"><font><font>&lt;Ether dst = 00：10：4b：b3：7d：4e src = 00：40：33：96：7b：60 type = 0x800 | &lt;IP version = 4L </font></font></span>
<span class="go"><font><font>ihl = 5L tos = 0x0 len = 60 id = 61681 flags = DF frag = 0L ttl = 64 proto = TCP chksum = 0xb85e </font></font></span>
<span class="go"><font><font>src = 192.168.8.10 dst = 192.168.8.1 options =''| &lt;TCP sport = 46511 dport = 80 </font></font></span>
<span class="go"><font><font>seq = 2023566040L ack = 0L dataofs = 10L reserved = 0L flags = SEC window = 5840 </font></font></span>
<span class="go"><font><font>chksum = 0x570c urgptr = 0 options = [（'Timestamp'，（342940201L，0L）），（'MSS'，1460），</font></font></span>
<span class="go"><font><font>（'NOP'，（）），（' '，''），（'WScale'，0）] | &gt;&gt;&gt; </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>load_module </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“p0f” </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>p0f </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>p </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>（1.0，['Linux 2.4.2  -  2.4.14（1） ']）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt;</font></font></span><span class="n"><font><font>a </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>sniff </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>prn </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>prnp0f </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>（1.0，['Linux 2.4.2  -  2.4.14（1）']）</font></font></span>
<span class="go"><font><font>（1.0，['Linux 2.4.2  -  2.4.14（1）']）</font></font></span>
<span class="go"><font><font>（0.875， 'Linux 2.4.2  -  2.4.14（1）'，'Linux 2.4.10（1）'，'Windows 98（？）']）</font></font></span>
<span class="go"><font><font>（1.0，['Windows 2000（9）']）</font></font></span>
</pre></div>
</div>
<p><font><font>操作系统猜测之前的数字是猜测的准确性。</font></font></p>
</div>
<div class="section" id="filters">
<h3><font><font>过滤器</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#filters" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p id="index-19"><font><font>bpf过滤器和sprintf（）方法的演示：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>a </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>sniff </font></font></span><span class="p"><font><font>（</font></font></span><span class="nb"><font><font>filter </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“tcp and（port 25 or port 110）” </font></font></span><span class="p"><font><font>，</font></font></span>
<span class="go"><font><font>prn = lambda x：x.sprintf（“％IP.src％：％TCP.sport％ - &gt;％IP.dst％： ％TCP.dport％％2s，TCP.flags％：％TCP.payload％“））</font></font></span>
<span class="go"><font><font>192.168.8.10:47226  - &gt; 213.228.0.14:110 S：</font></font></span>
<span class="go"><font><font>213.228.0.14 </font></font></span>
<font><span class="go"><font>: </font></span><span class="go"><font>110  - &gt; 192.168.8.10:47226 SA：</font></span></font><span class="go"><font><font>192.168 .8.10：47226  - &gt; 213.228.0.14:110 A：</font></font></span>
<span class="go"><font><font>213.228.0.14 </font></font></span>

<font><span class="go"><font>: </font></span><span class="go"><font>110  - &gt; 192.168.8.10:47226 PA：+ OK &lt;13103.1048117923@pop2-1.free.fr&gt; </font></span></font><span class="go"><font><font>192.168.8.10:47226  - &gt; 213.228.0.14 ：110 A：</font></font></span>
<span class="go"><font><font>192.168.8.10:47226  - &gt; 213.228.0.14:110 PA：USER toto </font></font></span>

<span class="go"><font><font>213.228.0.14:110  - &gt; 192.168.8.10:47226 A：</font></font></span>
<span class="go"><font><font>213.228.0.14 </font></font></span>

<font><span class="go"><font>: </font></span><span class="go"><font>110  - &gt; 192.168.8.10:47226 PA：+ OK </font></span></font><span class="go"><font><font>192.168.8.10：47226  - &gt; 213.228.0.14:110 A： </font></font></span>
<span class="go"><font><font>192.168.8.10 :47226  - &gt; 213.228.0.14:110 </font><font>PA：PASS tata </font></font></span>

<span class="go"><font><font>213.228.0.14:110  - &gt; 192.168.8.10:47226 PA：-ERR授权失败</font></font></span>

<span class="go"><font><font>192.168.8.10:47226  - &gt; 213.228.0.14:110 A：</font></font></span>
<span class="go"><font><font>213.228.0.14 </font></font></span>
<font><span class="go"><font>: </font></span><span class="go"><font>110  - &gt; 192.168.8.10:47226 FA：</font></span></font><span class="go"><font><font>192.168.8.10: </font></font></span>
<font><span class="go"><font>47226  - &gt; </font></span><span class="go"><font>213.228.0.14:110 FA：</font></span><span class="go"><font>213.228.0.14 </font></span><span class="go"><font>: </font></span></font><span class="go"><font><font>110  - &gt; 192.168.8.10:47226 A：</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="send-and-receive-in-a-loop">
<h3><font><font>发送和接收循环</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#send-and-receive-in-a-loop" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p id="index-20"><font><font>以下是一个（h）ping类功能的例子：你总是发送相同的数据包集，看看是否有变化：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>srloop </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“www.target.com/30” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（））</font></font></span>
<span class="go"><font><font>RECV 1：以太网/ IP / TCP 192.168.11.99:80&gt; 192.168.8.14:20 SA /填充</font></font></span>
<span class="go"><font><font>失败3：IP / TCP 192.168.8.14:20&gt; 192.168.11.96:80 S </font></font></span>
<span class="go"><font><font>        IP / TCP 192.168.8.14:20&gt; 192.168.11.98:80 S </font></font></span>
<span class="go"><font><font>        IP / TCP 192.168.8.14:20&gt; 192.168.11.97:80 S </font></font></span>
<span class="go"><font><font>RECV 1：以太网/ IP / TCP 192.168.11.99:80&gt; 192.168.8.14:20 SA / Padding failed </font></font></span>
<span class="go"><font><font>3：IP / TCP 192.168.8.14:20&gt; 192.168.11.96:80 S </font></font></span>
<span class="go"><font><font>        IP / TCP 192.168.8.14:20&gt; 192.168.11.98:80 S </font></font></span>
<span class="go"><font><font>        IP / TCP 192.168.8.14:20&gt; 192.168.11.97:80 S </font></font></span>
<span class="go"><font><font>RECV 1：Ether / IP / TCP 192.168.11.99:80&gt; 192.168.8.14：20 SA /填充</font></font></span>
<span class="go"><font><font>失败3：IP / TCP 192.168.8.14:20&gt; 192.168.11.96:80 S </font></font></span>
<span class="go"><font><font>        IP / TCP 192.168.8.14:20&gt; 192.168.11.98:80 S </font></font></span>
<span class="go"><font><font>        IP / TCP 192.168.8.14:20&gt; 192.168.11.97： 80 S </font></font></span>
<span class="go"><font><font>RECV 1：Ether / IP / TCP 192.168.11.99:80&gt; 192.168.8.14:20 SA /填充</font></font></span>
<span class="go"><font><font>失败3：IP / TCP 192.168.8.14:20&gt; 192.168.11.96:80 S </font></font></span>
<span class="go"><font><font>        IP / TCP 192.168.8.14:20 &gt; 192.168.11.98:80 S </font></font></span>
<font><span class="go"><font>        IP / TCP 192.168.8.14:20&gt; 192.168.11.97:80 S192.168.11.96:80 S </font></span><span class="go"><font>IP / TCP 192.168.8.14:20&gt; 192.168.11.98:80 S </font></span><span class="go"><font>IP / TCP 192.168.8.14:20&gt; 192.168.11.97:80 S192.168.11.96:80 S </font></span><span class="go"><font>IP / TCP 192.168.8.14:20&gt; 192.168.11.98:80 S </font></span></font><span class="go"><font><font>IP / TCP 192.168.8.14:20&gt; 192.168.11.97:80 S</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="importing-and-exporting-data">
<h3><font><font>导入和导出数据</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#importing-and-exporting-data" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<div class="section" id="pcap">
<h4><font><font>PCAP </font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#pcap" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>将捕获数据包保存到pcap文件以供以后使用或不同应用程序通常很有用：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>wrpcap </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“temp.cap” </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>pkts </font></font></span><span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
<p><font><font>要恢复以前保存的pcap文件：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>pkts </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>rdpcap </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“temp.cap” </font></font></span><span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
<p><font><font>要么</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>pkts </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>sniff </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>offline </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“temp.cap” </font></font></span><span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="hexdump">
<h4><font><font>进制打印</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#hexdump" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>Scapy允许您以各种十六进制格式导出记录的数据包。</font></font></p>
<p><font><font>使用</font></font><tt class="docutils literal"><span class="pre"><font><font>hexdump（）</font></font></span></tt><font><font>可以使用经典的hexdump格式显示一个或多个数据包：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>hexdump </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>pkt </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>0000 00 50 56 FC CE 50 00 0C 29 2B 53 19 08 00 45 00 .PV..P ..）+ S ... E。</font></font></span>
<span class="go"><font><font>0010 00 54 00 00 40 00 40 01 5A 7C C0 A8 19 82 04 02 .T .. @。@。Z | ... </font></font></span>
<span class="go"><font><font>0020 02 01 08 00 9C 90 5A 61 00 01 E6 DA 70 49 B6 E5 ...... Za .... pI .. </font></font></span>
<span class="go"><font><font>0030 08 00 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 ................ </font></font></span>
<span class="go"><font><font>0040 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 ..........“＃$％</font></font></span>
<span class="go"><font><font>0050 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35＆'（） * +， - 。/ 012345 </font></font></span>
<span class="go"><font><font>0060 36 37 67</font></font></span>
</pre></div>
</div>
<p><font><font>上面的Hexdump可以使用</font></font><tt class="docutils literal"><span class="pre"><font><font>import_hexcap（）</font></font></span></tt><font><font>重新导入Scapy </font><font>：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>pkt_hex </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>Ether </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>import_hexcap </font></font></span><span class="p"><font><font>（））</font></font></span>
<span class="go"><font><font>0000 00 50 56 FC CE 50 00 0C 29 2B 53 19 08 00 45 00 .PV..P ..）+ S ... E。</font></font></span>
<span class="go"><font><font>0010 00 54 00 00 40 00 40 01 5A 7C C0 A8 19 82 04 02 .T .. @。@。Z | ... </font></font></span>
<span class="go"><font><font>0020 02 01 08 00 9C 90 5A 61 00 01 E6 DA 70 49 B6 E5 ...... Za .... pI .. </font></font></span>
<span class="go"><font><font>0030 08 00 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 ................ </font></font></span>
<span class="go"><font><font>0040 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 ..........“＃$％</font></font></span>
<span class="go"><font><font>0050 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35＆'（） * +， - </font></font></span>
<font><span class="n"><font>。/ </font></span><span class="go"><font>012345 </font></span></font><span class="go"><font><font>0060 36 37 67 </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>pkt_hex </font></font></span>
<span class="go"><font><font>&lt;Ether dst = 00：50：56：fc：ce：50 src = 00：0c：29：2b：53：19 type = 0x800 |</font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="hex-string">
<h4><font><font>十六进制字符串</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#hex-string" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>您还可以使用</font></font><tt class="docutils literal"><span class="pre"><font><font>str（）</font></font></span></tt><font><font>函数</font><font>将整个数据包转换为十六进制字符串</font><font>：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>pkts </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>sniff </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>count </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>pkt </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>pkts </font></font></span><span class="p"><font><font>[ </font></font></span><span class="mi"><font><font>0 </font></font></span><span class="p"><font><font>] </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>pkt </font></font></span>
<span class="go"><font><font>&lt;ether dst = 00：50：56：fc：ce：50 src = 00：0c：29：2b：53 ：19 type = 0x800 | &lt;IP version = 4L </font></font></span>
<span class="go"><font><font>ihl = 5L tos = 0x0 len = 84 id = 0 flags = DF frag = 0L ttl = 64 proto = icmp chksum = 0x5a7c </font></font></span>
<span class="go"><font><font>src = 192.168.25.130 dst = 4.2.2.1 options = ''| &lt;ICMP type = echo-r​​equest code = 0 </font></font></span>
<span class="go"><font><font>chksum = 0x9c90 id = 0x5a61 seq = 0x1 | &lt;Raw load ='\ xe6 \ xdapI \ xb6 \ xe5 \ x08 \ x00 \ x08 \ t \ n </font></font></span>
<span class="go"><font><font>\ x0b \ x0c \ r \ x0e \ x0f \ x10 \ x11 \ x12 \ x13 \ x14 \ x15 \ x16 \ x17 \ x18 \ x19 \ x1a \ x1b \ x1c \ x1d \ x1e </font></font></span>
<span class="go"><font><font>\ x1f！“＃$％＆\'（）* + ， - 。/ 01234567'| &gt;&gt;&gt;&gt; </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt;</font></font></span><span class="n"><font><font>pkt_str </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="nb"><font><font>str </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>pkt </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>pkt_str </font></font></span>
<span class="go"><font><font>'\ x00PV \ xfc \ xceP \ x00 \ x0c）+ S \ x19 \ x08 \ x00E \ x00 \ x00 \ x00 \ x00 @ \ x00 @ \ x01Z | \ xc0 \ xa8 </font></font></span>
<span class="go"><font><font>\ x19 \ x82 \ x04 \ x02 \ x02 \ x01 \ x08 \ x00 \ x9c \ x90Za \ x00 \ x01 \ xe6 \ xdapI \ xb6 \ xe5 \ x08 \ x00 </font></font></span>
<span class="go"><font><font>\ x08 \ t \ n \ x0b \ x0 \ x0f \ x10 \ x11 \ x12 \ x13 \ x14 \ x15 \ x16 \ x17 \ x18 \ x19 \ x1a \ x1b </font></font></span>
<font><span class="go"><font>\ x1c \ x1d \ x1e \ x1f！“＃$％＆\'（）* +， - 。/ 01234567 “\ x00PV \ xfc \ xceP \ x00 \ x0c）+ S \ x19 \ x08 \ x00E \ x00 \ x00T \ x00 \ x00 @ \ x00 @ \ x01Z | \ xc0 \ xa8 </font></span><span class="go"><font>\ x19 \ x82 \ x04 \ x02 \ x02 \ x01 \ x08 \ x00 \ x9c \ x90Za \ x00 \ x01 \ xe6 \ xdapI \ xb6 \ xe5 \ x08 \ x00 </font></span><span class="go"><font>\ x08 \ t \ n \ x0b \ x0c \ r \ x0e \ x0 \ x10 \ x11 \ x12 \ x13 \ x14 \ x15 \ x16 \ x17 \ x18 \ x19 \ x1a \ x1b </font></span><span class="go"><font>\ x1c \ x1d \ x1e \ x1f！“＃$％＆\'（）* +， - 。/ 01234567'\ x00PV \ xfc \ xceP \ x00 \ x0c）+ S \ x19 \ x08 \ x00E \ x00 \ x00T \ x00 \ x00 @ \ x00 @ \ x01Z | \ xc0 \ xa8 </font></span><span class="go"><font>\ x19 \ x82 \ x04 \ x02 \ x02 \ x01 \ x08 \ x00 \ x9c \ x90Za \ x00 \ x01 \ xe6 \ xdapI \ xb6 \ xe5 \ x08 \ x00 </font></span><span class="go"><font>\ x08 \ t \ n \ x0b \ x0c \ r \ x0e \ x0 \ x10 \ x11 \ x12 \ x13 \ x14 \ x15 \ x16 \ x17 \ x18 \ x19 \ x1a \ x1b </font></span></font><span class="go"><font><font>\ x1c \ x1d \ x1e \ x1f！“＃$％＆\'（）* +， - 。/ 01234567'</font></font></span>
</pre></div>
</div>
<p><font><font>我们可以通过选择适当的起始层（例如</font></font><tt class="docutils literal"><span class="pre"><font><font>Ether（）</font></font></span></tt><font><font>）</font><font>重新生成生成的十六进制字符串</font><font>。</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>new_pkt </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>Ether </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>pkt_str </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>new_pkt </font></font></span>
<span class="go"><font><font>&lt;Ether dst = 00：50：56：fc：ce：50 src = 00：0c：29：2b：53：19 type = 0x800 | &lt;IP version = 4L </font></font></span>
<span class="go"><font><font>ihl = 5L tos = 0x0 len = 84 id = 0 flags = DF frag = 0L ttl = 64 proto = icmp chksum = 0x5a7c </font></font></span>
<span class="go"><font><font>src = 192.168.25.130 dst = 4.2.2.1 options =''| &lt;ICMP type = echo-r​​equest code = 0 </font></font></span>
<span class="go"><font><font>chksum = 0x9c90 id = 0x5a61 seq = 0x1 | &lt;Raw load ='\ xe6 \ xdapI \ xb6 \ xe5 \ x08 \ x00 \ x08 \ t \ n </font></font></span>
<span class="go"><font><font>\ x0b \ x0c \ r \ x0e \ x0f \ x10 \ x11 \ x12 \ x13 \ x14 \ x15 \ x16 \ x17 \ x18 \ x19 \ x1a \ x1b \ x1c \ x1d \ x1e </font></font></span>
<span class="go"><font><font>\ x1f！“＃$％＆\'（）* +， - 。/ 01234567'| &gt;&gt;&gt;&gt;</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="base64">
<h4><font><font>Base64编码</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#base64" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>使用</font></font><tt class="docutils literal"><span class="pre"><font><font>export_object（）</font></font></span></tt><font><font>函数，Scapy可以导出代表数据包的base64编码的Python数据结构：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>pkt </font></font></span>
<span class="go"><font><font>&lt;ether dst = 00：50：56：fc：ce：50 src = 00：0c：29：2b：53：19 type = 0x800 | &lt;IP version = 4L </font></font></span>
<span class="go"><font><font>ihl = 5L tos = 0x0 len = 84 id = 0 flags = DF frag = 0L ttl = 64 proto = icmp chksum = 0x5a7c </font></font></span>
<span class="go"><font><font>src = 192.168.25.130 dst = 4.2.2.1 options =''| &lt;ICMP type = echo-r​​equest code = 0 </font></font></span>
<span class="go"><font><font>chksum = 0x9c90 id = 0x5a61 seq = 0x1 | &lt;Raw load ='\ xe6 \ xdapI \ xb6 \ xe5 \ x08 \ x00 \ x08 \ t \ n </font></font></span>
<span class="go"><font><font>\ x0b \ x0c \ r \ x0e \ x0f \ x10 \ x11 \ x12 \ x13 \ x14 \ x15 \ x16 \ x17 \ x18 \ x19 \ x1a \ x1b \ x1c \ x1d \ x1e \ x1f </font></font></span>
<span class="go"><font><font>！“＃$％＆\'（）* +， - </font></font></span>
<font><span class="go"><font>。/ </font></span><span class="go"><font>01234567'| &gt;&gt;&gt;&gt; </font></span></font><span class="gp"><font><font>&gt;&gt;&gt;</font></font></span><span class="n"><font><font>export_object </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>PKT </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>eNplVwd4FNcRPt2dTqdTQ0JUUYwN + CgS0gkJONFEs5WxFDB + CdiI8 + pupVl0d7uzRUiYtcEGG4ST </font></font></span>
<span class="go"><font><font>OD1OnB6nN6c4cXrvwQmk2U5xA9tgO70XMm + 1rA78qdzbfTP / lDfzz7tD4WwmU1C0YiaT2Gqjaiao </font></font></span>
<span class="go"><font><font>bMlhCrsUSYrYoKbmcxZFXSpPiohlZikm6ltb063ZdGpNOjWQ7mhPt62hChHJWTbFvb0O / u1MD2bT </font></font></span>
<span class="go"><font><font>WZXXVCmi9pihUqI3FHdEQslriiVfWFTVT9VYpog6Q7fsjG0qRWtQNwsW1fRTrUg4xZxq5pUx1aS6 </font></font></span>
<span class="gp"><font><font>...</font></font></span>
</pre></div>
</div>
<p><font><font>以上输出可以使用</font></font><tt class="docutils literal"><span class="pre"><font><font>import_object（）</font></font></span></tt><font><font>重新导入Scapy </font><font>：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>new_pkt </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>import_object </font></font></span><span class="p"><font><font>（）</font></font></span>
<span class="go"><font><font>eNplVwd4FNcRPt2dTqdTQ0JUUYwN + CgS0gkJONFEs5WxFDB + CdiI8 + pupVl0d7uzRUiYtcEGG4ST </font></font></span>
<span class="go"><font><font>OD1OnB6nN6c4cXrvwQmk2U5xA9tgO70XMm + 1rA78qdzbfTP / lDfzz7tD4WwmU1C0YiaT2Gqjaiao </font></font></span>
<span class="go"><font><font>bMlhCrsUSYrYoKbmcxZFXSpPiohlZikm6ltb063ZdGpNOjWQ7mhPt62hChHJWTbFvb0O / u1MD2bT </font></font></span>
<span class="go"><font><font>WZXXVCmi9pihUqI3FHdEQslriiVfWFTVT9VYpog6Q7fsjG0qRWtQNwsW1fRTrUg4xZxq5pUx1aS6 </font></font></span>
<span class="gp"><font><font>... </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>new_pkt </font></font></span>
<span class="go"><font><font>&lt;以太DST = 00：50：56：FC：CE：50 SRC = 00： 0c：29：2b：53：19 type = 0x800 | &lt;IP version = 4L </font></font></span>
<span class="go"><font><font>ihl = 5L tos = 0x0 len = 84 id = 0 flags = DF frag = 0L ttl = 64 proto = icmp chksum = 0x5a7c </font></font></span>
<span class="go"><font><font>src = 192.168.25.130 dst = 4.2.2.1 options =''| &lt;ICMP type = echo-r​​equest code = 0 </font></font></span>
<span class="go"><font><font>chksum = 0x9c90 id = 0x5a61 seq = 0x1 | &lt;Raw load ='\ xe6 \ xdapI \ xb6 \ xe5 \ x08 \ x00 \ x08 \ t \ n </font></font></span>
<span class="go"><font><font>\ x0b \ x0c \ r \ x0e \ x0f \ x10 \ x11 \ x12 \ x13 \ x14 \ x15 \ x16 \ x17 \ x18 \ x19 \ \ x1b \ x1c \ x1d \ x1e \ x1f </font></font></span>
<font><span class="go"><font>！“＃$％＆\'（）* +， - </font></span><span class="go"><font>。/ </font></span></font><span class="go"><font><font>01234567'| &gt;&gt;&gt;&gt;</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="sessions">
<h4><font><font>会话</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#sessions" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>最后，Scapy能够使用</font></font><tt class="docutils literal"><span class="pre"><font><font>save_session（）</font></font></span></tt><font><font>函数</font><font>保存所有会话变量</font><font>：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="nb"><font><font>DIR </font></font></span><span class="p"><font><font>（）</font></font></span>
<span class="go"><font><font>[ '__builtins__'， 'CONF'， 'new_pkt'， 'PKT'， 'pkt_export'， 'pkt_hex'， 'pkt_str'， 'PKTS'] </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>save_session </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font> “session.scapy” </font></font></span><span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
<p><font><font>下次启动Scapy时，您可以使用</font></font><tt class="docutils literal"><span class="pre"><font><font>load_session（）</font></font></span></tt><font><font>命令</font><font>加载上一个保存的会话</font><font>：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="nb"><font><font>dir </font></font></span><span class="p"><font><font>（）</font></font></span>
<span class="go"><font><font>[' </font></font></span>
<font><span class="n"><font>__builtins__ </font></span><span class="go"><font>'，'conf'] </font></span></font><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>load_session </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“session.scapy” </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="nb"><font><font>dir </font></font></span><span class="p"><font><font>（）</font></font></span>
<span class="go"><font><font>['__builtins__'，'conf'，'new_pkt'，'pkt' pkt_export'，'pkt_hex'，'pkt_str'，'pkts']</font></font></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="making-tables">
<h3><font><font>制表</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#making-tables" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p id="index-21"><font><font>现在我们演示了</font></font><tt class="docutils literal"><span class="pre"><font><font>make_table（）</font></font></span></tt><font><font>演示功能。</font><font>它需要一个列表作为参数，并且返回一个3-uple的函数。</font><font>第一个元素是从列表的元素在x轴上的值，第二个是关于y值，第三个是我们要在坐标（x，y）处看到的值。</font><font>结果是一张桌子。</font><font>此函数有两个变体，</font></font><tt class="docutils literal"><span class="pre"><font><font>make_lined_table（）</font></font></span></tt><font><font>和</font></font><tt class="docutils literal"><span class="pre"><font><font>make_tex_table（）</font></font></span></tt><font><font>可以复制/粘贴到您的LaTeX最佳报告中。</font><font>这些函数可用作结果对象的方法：</font></font></p>
<p><font><font>这里我们可以看到一个多平行的traceroute（scapy已经有一个多TCP跟踪路由功能了）</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ANS </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>SR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“www.test.fr/30” </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>TTL </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>（</font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>6 </font></font></span><span class="p"><font><font>））</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（））</font></font></span>
<span class="go"><font><font>接收的数据包49，得到了24个答案，其余0包</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>答</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>make_table </font></font></span><span class="p"><font><font>（</font></font></span> <span class="k"><font><font>拉姆达</font></font></span> <span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R </font></font></span><span class="p"><font><font>）：</font></font></span> <span class="p"><font><font>（</font></font></span><font><span class="p"><font> </font></span></font><span class="n"><font><font>小号</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>DST </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>小号</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>TTL </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>- [R </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>SRC </font></font></span><span class="p"><font><font>）</font></font></span> <span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>  216.15.189.192 216.15.189.193 216.15.189.194 216.15.189。</font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
</pre></div>
</div>
<p><font><font>这是一个更复杂的例子，用于从其IPID字段中识别机器。</font><font>我们可以看到，172.20.80.200:22由与172.20.80.201相同的IP协议栈应答，而172.20.80.197:25没有被sape IP协议栈应答，而不是同一个IP上的其他端口。</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ANS </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>SR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“172.20.80.192/28” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DPORT </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>[ </font></font></span><span class="mi"><font><font>20 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>21 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>22 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>25 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>53 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>80 </font></font></span><span class="p"><font><font>]））</font></font></span>
<span class="go"><font><font>接收的数据包142，得到了25个答案，其余71包</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>make_table </font></font></span><span class="p"><font><font>（</font></font></span><span class="k"><font><font>拉姆达</font></font></span> <span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R </font></font></span><span class="p"><font><font>）：</font></font></span> <span class="p"><font><font>（</font></font></span><font><span class="p"><font> </font></span></font><span class="n"><font><font>小号</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>DST </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>小号</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>DPORT </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>- [R </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font></font></span><span class="p"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
</pre></div>
</div>
<p><font><font>当使用TTL，显示收到的TTL等时，它可以很容易地识别网络拓扑。</font></font></p>
</div>
<div class="section" id="routing">
<h3><font><font>路由</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#routing" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p id="index-22"><font><font>现在scapy有自己的路由表，所以你可以让你的数据包路由不同于系统：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>CONF </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>路由</font></font></span>
<span class="go"><font><font>网络掩码网关Iface </font></font></span>
<span class="go"><font><font>127.0.0.0 255.0.0.0 0.0.0.0 lo </font></font></span>
<span class="go"><font><font>192.168.8.0 255.255.255.0 0.0.0.0 eth0 </font></font></span>
<span class="go"><font><font>0.0.0.0 0.0.0.0 192.168.8.1 eth0 </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>conf </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>路线</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>delt </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>net </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“0.0.0.0/0” </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>gw </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168.8.1” </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>conf </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>路线</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>add </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>net </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“0.0.0.0/0” </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>gw </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168.8.254” </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="gp"><font><font>&gt;&gt; </font></font></span><span class="n"><font><font>&gt; conf </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>路线</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>add </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>host </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168.1.1” </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>gw </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168.8.1” </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>conf </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>路由</font></font></span>
<span class="go"><font><font>网络掩码网关Iface </font></font></span>
<span class="go"><font><font>127.0.0.0 255.0.0.0 0.0.0.0 lo </font></font></span>
<span class="go"><font><font>192.168.8.0 255.255.255.0 0.0.0.0 eth0 </font></font></span>
<span class="go"><font><font>0.0.0.0 0.0.0.0 192.168.8.254 eth0 </font></font></span>
<span class="go"><font><font>192.168.1.1 255.255.255.255 192.168.8.1 eth0 </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>conf </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>路线</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>resync </font></font></span><span class="p"><font><font>（）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>conf </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="gnuplot">
<h3><font><font>gnuplot的</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#gnuplot" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p id="index-23"><font><font>我们可以使用Gnuplot轻松绘制一些收获的值。</font><font>（确保您已经安装了Gnuplot-py和Gnuplot。）例如，我们可以观察到IP ID模式，以了解负载平衡器后面使用了多少个不同的IP堆栈：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>a </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>b </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>sr </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“www.target.com” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>sport </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>[ </font></font></span><span class="n"><font><font>RandShort </font></font></span><span class="p"><font><font>（）] </font></font></span><span class="o"><font><font>* </font></font></span><span class="mi"><font><font>1000 </font></font></span><span class="p"><font><font>））</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>a </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>情节</font></font></span><span class="p"><font><font>（</font></font></span><span class="k"><font><font>拉姆达</font></font></span> <span class="n"><font><font>X </font></font></span><span class="p"><font><font>：</font></font></span><span class="n"><font><font>X </font></font></span><span class="p"><font><font>[ </font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>] </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>ID </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>&lt;Gnuplot._Gnuplot.Gnuplot在0xb7d6a74c实例&gt;</font></font></span>
</pre></div>
</div>
<img alt="_images / ipid.png" src="./用法 - Scapy v2.1.1-dev文档_files/ipid.png">
</div>
<div class="section" id="tcp-traceroute-2">
<h3><font><font>TCP跟踪路由（2）</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#tcp-traceroute-2" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p id="index-24"><font><font>Scapy还具有强大的TCP跟踪路由功能。</font><font>不像其他跟踪路由程序等待每个节点在进行下一个回复之前，scapy同时发送所有数据包。</font><font>这具有不能知道何时停止（因此是maxttl参数）的缺点，但是获得此多目标跟踪路由结果所需的时间少于3秒的巨大优点是：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>traceroute </font></font></span><span class="p"><font><font>（[ </font></font></span><span class="s"><font><font>“www.yahoo.com” </font></font></span><span class="p"><font><font>，</font></font></span><span class="s"><font><font>“www.altavista.com” </font></font></span><span class="p"><font><font>，</font></font></span><span class="s"><font><font>“www.wisenut.com” </font></font></span><span class="p"><font><font>，</font></font></span><span class="s"><font><font>“www.copernic.com” </font></font></span><span class="p"><font><font>]，</font></font></span><span class="n"><font><font>maxttl </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>20 </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>收到80个数据包，得到80个答案，剩余0包</font></font></span>
<span class="go"><font><font>   193.45.10.88:80 216.109.118.79:80 64.241.242.243:80 66.94.229.254:80 </font></font></span>
<span class="go"><font><font>1 192.168.8.1 192.168.8.1 192.168.8.1 192.168.8.1 </font></font></span>
<span class="go"><font><font>2 82.243.5.254 82.243.5.254 82.243.5.254 82.243.5.254 </font></font></span>
<span class="go"><font><font>3 213.228.4.254 213.228.4.254 213.228.4.254 213.228.4.254 </font></font></span>
<span class="go"><font><font>4 212.27.50.46 212.27.50.46 212.27.50.46 212.27.50.46 </font></font></span>
<span class="go"><font><font>5 212.27.50.37 212.27.50。41 212.27.50.37 212.27.50.41 </font></font></span>
<span class="go"><font><font>6 212.27.50.34 212.27.50.34 213.228.3.234 193.251.251.69 </font></font></span>
<span class="go"><font><font>7 213.248.71.141 217.118.239.149 208.184.231.214 193.251.241.178 </font></font></span>
<span class="go"><font><font>8 213.248.65.81 217.118.224.44 64.125.31.129 193.251.242.98 </font></font></span>
<span class="go"><font><font>9 213.248.70.14 213.206.129.85 64.125.31.186 193.251.243.89 </font></font></span>
<span class="go"><font><font>10 193.45.10.88 SA 213.206.128.160 64.125.29.122 193.251.254.126 </font></font></span>
<span class="go"><font><font>11 193.45.10.88 SA 206.24.169.41 64.125.28.70 216.115.97.178 </font></font></span>
<span class="go"><font><font>12 193.45.10.88 SA 206.24.226.99 64.125.28.209 66.218。 64.146 </font></font></span>
<span class="go"><font><font>13 193.45.10.88 SA 206.24.227.106 64.125.29.45 66.218.82.230 </font></font></span>
<span class="go"><font><font>14 193.45.10.88 SA 216.109.74.30 64.125.31.214 66.94.229.254 SA </font></font></span>
<span class="go"><font><font>15 193.45.10.88 SA 216.109。120.149 64.124.229.109 66.94.229.254 SA </font></font></span>
<span class="go"><font><font>16 193.45.10.88 SA 216.109.118.79 SA 64.241.242.243 SA 66.94.229.254 SA </font></font></span>
<span class="go"><font><font>17 193.45.10.88 SA 216.109.118.79 SA 64.241.242.243 SA 66.94.229.254 SA </font></font></span>
<span class="go"><font><font>18 193.45.10.88 SA 216.109.118.79 SA 64.241.242.243 SA 66.94.229.254 SA </font></font></span>
<span class="go"><font><font>19 193.45.10.88 SA 216.109.118.79 SA 64.241.242.243 SA 66.94.229.254 SA </font></font></span>
<span class="go"><font><font>20 193.45.10.88 SA 216.109.118.79 SA 64.241.242.243 SA 66.94.229.254 SA </font></font></span>
<font><span class="go"><font>（&lt;Traceroute：UDP：0 TCP：28 ICMP：52其他：0&gt;，&lt;未应答：UDP：0 TCP：0 ICMP：0其他：0&gt;）45.10.88 SA 216.109.118.79 SA 64.241.242.243 SA 66.94.229.254 SA </font></span><span class="go"><font>19 193.45.10.88 SA 216.109.118.79 SA 64.241.242.243 SA 66.94.229.254 SA </font></span><span class="go"><font>20 193.45.10.88 SA 216.109.118.79 SA 64.241.242.243 SA 66.94.229.254 SA </font></span><span class="go"><font>（&lt;Traceroute：UDP：0 TCP：28 ICMP：52其他：0&gt;，&lt;未回答：UDP：0 TCP：0 ICMP：0其他：0&gt;）45.10.88 SA 216.109.118.79 SA 64.241.242.243 SA 66.94.229.254 SA </font></span><span class="go"><font>19 193.45.10.88 SA 216.109.118.79 SA 64.241.242.243 SA 66.94.229.254 SA </font></span><span class="go"><font>20 193.45.10.88 SA 216.109.118.79 SA 64.241.242.243 SA 66.94.229.254 SA </font></span></font><span class="go"><font><font>（&lt;Traceroute：UDP：0 TCP：28 ICMP：52其他：0&gt;，&lt;未回答：UDP：0 TCP：0 ICMP：0其他：0&gt;）</font></font></span>
</pre></div>
</div>
<p><font><font>实际上，最后一行是函数的结果：traceroute结果对象和未应答数据包的数据包列表。</font><font>traceroute结果是一个更专业的版本（实际上是一个实际上是一个经典结果对象的子类）。</font><font>我们可以保存它再次查询traceroute结果，或者深入检查其中一个答案，例如检查填充。</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>result </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>_ </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>result </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>show </font></font></span><span class="p"><font><font>（）</font></font></span>
<span class="go"><font><font>   193.45.10.88:80 216.109.118.79:80 64.241.242.243:80 66.94.229.254:80 </font></font></span>
<span class="go"><font><font>1 192.168.8.1 192.168.8.1 192.168.8.1 192.168.8.1 </font></font></span>
<span class="go"><font><font>2 82.251.4.254 82.251.4.254 82.251.4.254 82.251.4.254 </font></font></span>
<span class="go"><font><font>3 213.228.4.254 213.228.4.254 213.228.4.254 213.228.4.254 </font></font></span>
<span class="go"><font><font>[...] </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>结果</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>filter </font></font></span><span class="p"><font><font>（</font></font></span><span class="k"><font><font>lambda </font></font></span> <span class="n"><font><font>x </font></font></span><span class="p"><font><font>：</font></font></span> <span class="n"><font><font>Padding </font></font></span> <span class="ow"><font><font>in </font></font></span> <span class="n"><font><font>x </font></font></span><span class="p"><font><font>[ </font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>]）</font></font></span>
</pre></div>
</div>
<p><font><font>像任何结果对象一样，可以添加traceroute对象：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font></font></span><font><span class="go"><font>25 SA 20 195.101.94.25 SA </font></span><span class="go"><font>&gt;&gt;&gt; </font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>r3 </font></span><span class="o"><font>= </font></span><span class="n"><font>result </font></span><span class="o"><font>+ </font></span><span class="n"><font>r2 </font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>r3 </font></span><span class="o"><font>。</font></span><span class="n"><font>show </font></span><span class="p"><font>（）</font></span><span class="go"><font>   195.101.94.25:80 212.23.37.13:80 216.109.118.72:80 64.241.242.243:80 66.94.229.254:80 </font></span><span class="go"><font>1 192.168.8.1 192.168.8.1 192.168.8.1 192.168.8.1 192.168.8.1 </font></span><span class="go"><font>2 82.251.4.254 82.251。 4.254 82.251.4.254 82.251.4.254 82.251.4.254 </font></span><span class="go"><font>3 213.228.4.254 213.228.4.254 213.228.4.254 213.228.4.254 213.228.4.254 </font></span><span class="go"><font>4 212.27.50.169 212.27.50.169 212.27.50.46  -  212.27.50.46 </font></span><span class="go"><font>5 212.27.50.162 212.27.50.162 212.27.50.37 212.27.50.41 212.27。</font></span></font><span class="n"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="mi"><font></font></span><span class="p"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="gp"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span>
<span class="gp"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
</pre></div>
</div>
<p><font><font>Traceroute结果对象也具有非常整洁的功能：他们可以从他们获得的所有路由中创建一个有向图，并通过AS进行聚类。</font><font>你将需要graphviz。</font><font>默认情况下，ImageMagick用于显示图形。</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font></font></span><font><span class="go"><font>2 82.251.4.254 82.251.4.254 82.251.4.254 82.251.4.254 82.251 ... </font></span><span class="go"><font>3 213.228.4.254 213.228.4.254 213.228.4.254 213.228.4.254 213.22 ... </font></span><span class="go"><font>[...] </font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>res </font></span><span class="o"><font>。</font></span><span class="n"><font>graph </font></span><span class="p"><font>（）</font></span><span class="c"><font>＃管道到ImageMagick的显示程序。</font></span><span class="c"><font>下图。</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>水库</font></span><span class="o"><font>。</font></span><span class="n"><font>图</font></span><span class="p"><font>（</font></span><span class="nb"><font>type </font></span><span class="o"><font>= </font></span><span class="s"><font>“ps” </font></span><span class="p"><font>，</font></span><span class="n"><font>target </font></span><span class="o"><font>= </font></span><span class="s"><font>“| lp” </font></span><span class="p"><font>）</font></span><span class="c"><font>＃管道到postscript打印机</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>res </font></span><span class="o"><font>。</font></span><span class="n"><font>曲线图</font></span><span class="p"><font>（</font></span><span class="n"><font>目标</font></span><span class="o"><font>= </font></span><span class="s"><font>“&gt; /tmp/graph.svg” ）</font></span><span class="p"><font>＃</font></span><span class="c"><font>保存到文件 </font></span><span class="go"><font>254 82.251.4.254 82.251.4.254 82.251.4.254 82.251 ... 3 213.228.4.254 213.228.4.254 213.228.4.254 213.228.4.254 213.22 ... </font></span><span class="go"><font>[...] </font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>res </font></span><span class="o"><font>。</font></span><span class="n"><font>graph </font></span><span class="p"><font>（）</font></span><span class="c"><font>＃管道到ImageMagick的显示程序。</font></span><span class="c"><font>下图。</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>水库</font></span><span class="o"><font>。</font></span><span class="n"><font>图</font></span><span class="p"><font>（</font></span><span class="nb"><font>type </font></span><span class="o"><font>= </font></span><span class="s"><font>“ps” </font></span><span class="p"><font>，</font></span><span class="n"><font>target </font></span><span class="o"><font>= </font></span><span class="s"><font>“| lp” </font></span><span class="p"><font>）</font></span><span class="c"><font>＃管道到postscript打印机</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>res </font></span><span class="o"><font>。</font></span><span class="n"><font>曲线图</font></span><span class="p"><font>（</font></span><span class="n"><font>目标</font></span><span class="o"><font>= </font></span><span class="s"><font>“&gt; /tmp/graph.svg” ）</font></span><span class="p"><font>＃</font></span><span class="c"><font>保存到文件 </font></span><span class="go"><font>254 82.251.4.254 82.251.4.254 82.251.4.254 82.251 ... 3 213.228.4.254 213.228.4.254 213.228.4.254 213.228.4.254 213.22 ... </font></span><span class="go"><font>[...] </font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>res </font></span><span class="o"><font>。</font></span><span class="n"><font>graph </font></span><span class="p"><font>（）</font></span><span class="c"><font>＃管道到ImageMagick的显示程序。</font></span><span class="c"><font>下图。</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>水库</font></span><span class="o"><font>。</font></span><span class="n"><font>图</font></span><span class="p"><font>（</font></span><span class="nb"><font>type </font></span><span class="o"><font>= </font></span><span class="s"><font>“ps” </font></span><span class="p"><font>，</font></span><span class="n"><font>target </font></span><span class="o"><font>= </font></span><span class="s"><font>“| lp” </font></span><span class="p"><font>）</font></span><span class="c"><font>＃管道到postscript打印机</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>res </font></span><span class="o"><font>。</font></span><span class="n"><font>曲线图</font></span><span class="p"><font>（</font></span><span class="n"><font>目标</font></span><span class="o"><font>= </font></span><span class="s"><font>“&gt; /tmp/graph.svg” ）</font></span><span class="p"><font>＃</font></span><span class="c"><font>保存到文件 </font></span><span class="go"><font>251.4.254 82.251 ... 3 213.228.4.254 213.228.4.254 213.228.4.254 213.228.4.254 213.22 ... </font></span><span class="go"><font>[...] </font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>res </font></span><span class="o"><font>。</font></span><span class="n"><font>graph </font></span><span class="p"><font>（）</font></span><span class="c"><font>＃管道到ImageMagick的显示程序。</font></span><span class="c"><font>下图。</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>水库</font></span><span class="o"><font>。</font></span><span class="n"><font>图</font></span><span class="p"><font>（</font></span><span class="nb"><font>type </font></span><span class="o"><font>= </font></span><span class="s"><font>“ps” </font></span><span class="p"><font>，</font></span><span class="n"><font>target </font></span><span class="o"><font>= </font></span><span class="s"><font>“| lp” </font></span><span class="p"><font>）</font></span><span class="c"><font>＃管道到postscript打印机</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>res </font></span><span class="o"><font>。</font></span><span class="n"><font>曲线图</font></span><span class="p"><font>（</font></span><span class="n"><font>目标</font></span><span class="o"><font>= </font></span><span class="s"><font>“&gt; /tmp/graph.svg” ）</font></span><span class="p"><font>＃</font></span><span class="c"><font>保存到文件 </font></span><span class="go"><font>251.4.254 82.251 ... 3 213.228.4.254 213.228.4.254 213.228.4.254 213.228.4.254 213.22 ... </font></span><span class="go"><font>[...] </font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>res </font></span><span class="o"><font>。</font></span><span class="n"><font>graph </font></span><span class="p"><font>（）</font></span><span class="c"><font>＃管道到ImageMagick的显示程序。</font></span><span class="c"><font>下图。</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>水库</font></span><span class="o"><font>。</font></span><span class="n"><font>图</font></span><span class="p"><font>（</font></span><span class="nb"><font>type </font></span><span class="o"><font>= </font></span><span class="s"><font>“ps” </font></span><span class="p"><font>，</font></span><span class="n"><font>target </font></span><span class="o"><font>= </font></span><span class="s"><font>“| lp” </font></span><span class="p"><font>）</font></span><span class="c"><font>＃管道到postscript打印机</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>res </font></span><span class="o"><font>。</font></span><span class="n"><font>曲线图</font></span><span class="p"><font>（</font></span><span class="n"><font>目标</font></span><span class="o"><font>= </font></span><span class="s"><font>“&gt; /tmp/graph.svg” ）</font></span><span class="p"><font>＃</font></span><span class="c"><font>保存到文件 </font></span><span class="go"><font>254 213.228.4.254 213.22 ... [...] </font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>res </font></span><span class="o"><font>。</font></span><span class="n"><font>graph </font></span><span class="p"><font>（）</font></span><span class="c"><font>＃管道到ImageMagick的显示程序。</font></span><span class="c"><font>下图。</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>水库</font></span><span class="o"><font>。</font></span><span class="n"><font>图</font></span><span class="p"><font>（</font></span><span class="nb"><font>type </font></span><span class="o"><font>= </font></span><span class="s"><font>“ps” </font></span><span class="p"><font>，</font></span><span class="n"><font>target </font></span><span class="o"><font>= </font></span><span class="s"><font>“| lp” </font></span><span class="p"><font>）</font></span><span class="c"><font>＃管道到postscript打印机</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>res </font></span><span class="o"><font>。</font></span><span class="n"><font>曲线图</font></span><span class="p"><font>（</font></span><span class="n"><font>目标</font></span><span class="o"><font>= </font></span><span class="s"><font>“&gt; /tmp/graph.svg” ）</font></span><span class="p"><font>＃</font></span><span class="c"><font>保存到文件 </font></span><span class="go"><font>254 213.228.4.254 213.22 ... [...] </font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>res </font></span><span class="o"><font>。</font></span><span class="n"><font>graph </font></span><span class="p"><font>（）</font></span><span class="c"><font>＃管道到ImageMagick的显示程序。</font></span><span class="c"><font>下图。</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>水库</font></span><span class="o"><font>。</font></span><span class="n"><font>图</font></span><span class="p"><font>（</font></span><span class="nb"><font>type </font></span><span class="o"><font>= </font></span><span class="s"><font>“ps” </font></span><span class="p"><font>，</font></span><span class="n"><font>target </font></span><span class="o"><font>= </font></span><span class="s"><font>“| lp” </font></span><span class="p"><font>）</font></span><span class="c"><font>＃管道到postscript打印机</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>res </font></span><span class="o"><font>。</font></span><span class="n"><font>曲线图</font></span><span class="p"><font>（</font></span><span class="n"><font>目标</font></span><span class="o"><font>= </font></span><span class="s"><font>“&gt; /tmp/graph.svg” ）</font></span><span class="p"><font>＃</font></span><span class="c"><font>保存到文件 </font></span><span class="gp"><font>下图。</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>水库</font></span><span class="o"><font>。</font></span><span class="n"><font>图</font></span><span class="p"><font>（</font></span><span class="nb"><font>type </font></span><span class="o"><font>= </font></span><span class="s"><font>“ps” </font></span><span class="p"><font>，</font></span><span class="n"><font>target </font></span><span class="o"><font>= </font></span><span class="s"><font>“| lp” </font></span><span class="p"><font>）</font></span><span class="c"><font>＃管道到postscript打印机</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>res </font></span><span class="o"><font>。</font></span><span class="n"><font>曲线图</font></span><span class="p"><font>（</font></span><span class="n"><font>目标</font></span><span class="o"><font>= </font></span><span class="s"><font>“&gt; /tmp/graph.svg” ）</font></span><span class="p"><font>＃</font></span><span class="c"><font>保存到文件 </font></span><span class="gp"><font>下图。</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>水库</font></span><span class="o"><font>。</font></span><span class="n"><font>图</font></span><span class="p"><font>（</font></span><span class="nb"><font>type </font></span><span class="o"><font>= </font></span><span class="s"><font>“ps” </font></span><span class="p"><font>，</font></span><span class="n"><font>target </font></span><span class="o"><font>= </font></span><span class="s"><font>“| lp” </font></span><span class="p"><font>）</font></span><span class="c"><font>＃管道到postscript打印机</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>res </font></span><span class="o"><font>。</font></span><span class="n"><font>曲线图</font></span><span class="p"><font>（</font></span><span class="n"><font>目标</font></span><span class="o"><font>= </font></span><span class="s"><font>“&gt; /tmp/graph.svg” ）</font></span><span class="p"><font>＃</font></span><span class="c"><font>保存到文件</font></span></font><span class="n"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span> <span class="o"><font></font></span> <span class="n"><font></font></span><span class="p"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="p"><font></font></span><span class="mi"><font></font></span><span class="p"><font></font></span><span class="mi"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="mi"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="mi"><font></font></span><span class="p"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="gp"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span>                          <span class="c"><font></font></span>
<span class="gp"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span><span class="nb"><font></font></span><span class="o"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span>   <span class="c"><font></font></span>
<span class="gp"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span><span class="n"><font></font></span><span class="o"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span> <span class="c"><font></font></span>
</pre></div>
</div>
<img alt="_images / graph_traceroute.png" src="./用法 - Scapy v2.1.1-dev文档_files/graph_traceroute.png">
<p><font><font>如果您安装了VPython，您还可以拥有traceroute的3D表示。</font><font>用右边的按钮，你可以旋转场景，用中间的按钮，你可以放大左边的按钮，你可以移动场景。</font><font>如果你点击一个球，它的IP将会出现/消失。</font><font>如果您按住Ctrl键点击球，将扫描端口21,22,23,25,80和443，并显示结果：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>水库</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>trace3D </font></font></span><span class="p"><font><font>（）</font></font></span>
</pre></div>
</div>
<img alt="_images / trace3d_1.png" src="./用法 - Scapy v2.1.1-dev文档_files/trace3d_1.png">
<img alt="_images / trace3d_2.png" src="./用法 - Scapy v2.1.1-dev文档_files/trace3d_2.png">
</div>
<div class="section" id="wireless-frame-injection">
<h3><font><font>无线帧注入</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#wireless-frame-injection" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p id="index-25"><font><font>如果您的无线网卡和驱动程序配置正确，进行帧注入</font></font></p>
<div class="highlight-python"><pre><font><font>$ ifconfig wlan0 up </font></font><font><font>
$ iwpriv wlan0 hostapd 1 </font></font><font><font>
$ ifconfig wlan0ap up</font></font></pre>
</div>
<p><font><font>你可以有一种FakeAP：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>sendp </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>Dot11 </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>ADDR1 </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“FF：FF：FF：FF：FF：FF” </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>ADDR2 </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>RandMAC </font></font></span><span class="p"><font><font>（），</font></font></span><span class="n"><font><font>ADDR3 </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>RandMAC </font></font></span><span class="p"><font><font>（））</font></font></span><span class="o"><font><font>/ </font></font></span>
<span class="go"><font><font>          Dot11Beacon（帽= “ESS”）/ </font></font></span>
<span class="go"><font><font>          Dot11Elt（ID =” SSID“，info = RandString（RandNum（1,50）））/ </font></font></span>
<span class="go"><font><font>          Dot11Elt（ID =”Rates“，info ='\ x82 \ x84 \ x0b \ x16'）/ </font></font></span>
<span class="go"><font><font>          Dot11Elt（ID =”DSset“，info = x03“）/ </font></font></span>
<span class="go"><font><font>          Dot11Elt（ID =”TIM“，info =”\ x00 \ x01 \ x00 \ x00“），iface =”wlan0ap“，循环= 1）</font></font></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="simple-one-liners">
<h2><font><font>简单的单行</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#simple-one-liners" title="固定到这个标题"><font><font>¶</font></font></a></h2>
<div class="section" id="ack-scan">
<h3><font><font>ACK扫描</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#ack-scan" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p><font><font>使用Scapy强大的数据包处理工具，我们可以快速复制经典的TCP扫描。</font><font>例如，将发送以下字符串以模拟ACK扫描：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ANS </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>SR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“www.slashdot.org” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DPORT </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>[ </font></font></span><span class="mi"><font><font>80 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>666 </font></font></span><span class="p"><font><font>]，</font></font></span><span class="n"><font><font>标志</font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“A” </font></font></span><span class="p"><font><font>））</font></font></span>
</pre></div>
</div>
<p><font><font>我们可以在应答的数据包中找到未过滤的端口：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="k"><font><font>对于</font></font></span> <span class="n"><font><font>s </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>r </font></font></span> <span class="ow"><font><font>in </font></font></span> <span class="n"><font><font>ans </font></font></span><span class="p"><font><font>：</font></font></span>
<span class="gp"><font><font>... </font></font></span>    <span class="k"><font><font>如果</font></font></span> <span class="n"><font><font>s </font></font></span><span class="p"><font><font>[ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>] </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>dport </font></font></span> <span class="o"><font><font>== </font></font></span> <span class="n"><font><font>r </font></font></span><span class="p"><font><font>[ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>] </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>运动</font></font></span><span class="p"><font><font>：</font></font></span>
<span class="gp"><font><font>... </font></font></span>       <span class="k"><font><font>打印</font></font></span> <span class="nb"><font><font>STR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>[ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>] </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>DPORT </font></font></span><span class="p"><font><font>）</font></font></span> <span class="o"><font><font>+ </font></font></span> <span class="s"><font><font>“是未过滤”</font></font></span>
</pre></div>
</div>
<p><font><font>类似地，可以使用未应答的数据包找到过滤的端口：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="k"><font><font>用于</font></font></span> <span class="n"><font><font>小号</font></font></span> <span class="ow"><font><font>在</font></font></span> <span class="n"><font><font>unans </font></font></span><span class="p"><font><font>：</font></font></span>
<span class="gp"><font><font>... </font></font></span>    <span class="k"><font><font>打印</font></font></span> <span class="nb"><font><font>STR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>[ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>] </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>DPORT </font></font></span><span class="p"><font><font>）</font></font></span> <span class="o"><font><font>+ </font></font></span> <span class="s"><font><font>“过滤”</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="xmas-scan">
<h3><font><font>圣诞扫描</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#xmas-scan" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p><font><font>可以使用以下命令启动圣诞扫描：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>sr </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168.1.1” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dport </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>666 </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>flags </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“FPU” </font></font></span><span class="p"><font><font>）</font></font></span> <span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
<p><font><font>检查RST响应将显示目标上的封闭端口。</font></font></p>
</div>
<div class="section" id="ip-scan">
<h3><font><font>IP扫描</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#ip-scan" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p><font><font>较低级别的IP扫描可用于枚举支持的协议：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ANS </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>SR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168.1.1” </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>原</font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>（</font></font></span><span class="mi"><font><font>0 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>255 </font></font></span><span class="p"><font><font>））</font></font></span><span class="o"><font><font>/ </font></font></span><span class="s"><font><font>“Scapy的” </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>重试</font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>2 </font></font></span><span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="arp-ping">
<h3><font><font>ARP </font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#arp-ping" title="固定到这个标题"><font><font>Ping¶</font></font></a></h3>
<p><font><font>在本地以太网网络上发现主机的最快方法是使用ARP Ping方法：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ANS </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>SRP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>以太</font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“FF：FF：FF：FF：FF：FF” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>ARP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>pdst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168.1.0/24” </font></font></span><span class="p"><font><font>），</font></font></span><span class="n"><font><font>超时</font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>2 </font></font></span><span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
<p><font><font>可以使用以下命令查看答案：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>概要</font></font></span><span class="p"><font><font>（</font></font></span><span class="k"><font><font>拉姆达</font></font></span> <span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R </font></font></span><span class="p"><font><font>）：</font></font></span> <span class="n"><font><font>- [R </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>的sprintf </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“ </font></font></span><span class="si"><font><font>％E </font></font></span><span class="s"><font><font>ther.src </font></font></span><span class="si"><font><font>％％</font></font></span><span class="s"><font><font>ARP.psrc％” ）</font></font></span><font><span class="p"><font>）</font></span></font><span class="p"><font></font></span> <span class="p"><font></font></span>
</pre></div>
</div>
<p><font><font>Scapy还包含一个内置的arping（）函数，它与上述两个命令类似：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>arping </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“192.168.1。*” </font></font></span><span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="icmp-ping">
<h3><font><font>ICMP </font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#icmp-ping" title="固定到这个标题"><font><font>Ping¶</font></font></a></h3>
<p><font><font>可以使用以下命令模拟Classical ICMP Ping：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>sr </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168.1.1-254” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>ICMP </font></font></span><span class="p"><font><font>（））</font></font></span>
</pre></div>
</div>
<p><font><font>有关实时主机的信息可以通过以下请求进行收集：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>概要</font></font></span><span class="p"><font><font>（</font></font></span><span class="k"><font><font>拉姆达</font></font></span> <span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R </font></font></span><span class="p"><font><font>）：</font></font></span> <span class="n"><font><font>- [R </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>的sprintf </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“％IP.src </font></font></span><span class="si"><font><font>％I </font></font></span><span class="s"><font><font>还活着” </font></font></span><span class="p"><font><font>）</font></font></span> <span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="tcp-ping">
<h3><font><font>TCP </font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#tcp-ping" title="固定到这个标题"><font><font>Ping¶</font></font></a></h3>
<p><font><font>在ICMP回应请求被阻止的情况下，我们仍然可以使用TCP SYN Ping等TCP TCP，</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>sr </font></font></span><span class="p"><font><font>（</font></font></span> <span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168.1。*” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dport </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>80 </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>flags </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“S” </font></font></span><span class="p"><font><font>）</font></font></span> <span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
<p><font><font>对我们的探测器的任何响应将指示一个活动主机。</font><font>我们可以通过以下命令收集结果：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>概要</font></font></span><span class="p"><font><font>（</font></font></span> <span class="k"><font><font>拉姆达</font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R ）</font></font></span><font><span class="p"><font>：</font></span></font><span class="p"><font><font> </font></font></span> <font><span class="n"><font>- [R </font></span><span class="o"><font>。</font></span><span class="n"><font>的sprintf </font></span><span class="p"><font>（</font></span><span class="s"><font>“％IP.src </font></span><span class="si"><font>％I </font></span><span class="s"><font>还活着” </font></span><span class="p"><font>）</font></span><span class="p"><font>）</font></span></font><span class="p"><font></font></span> <span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span><span class="s"><font></font></span><span class="si"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span> <span class="p"><font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="udp-ping">
<h3><font><font>UDP </font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#udp-ping" title="固定到这个标题"><font><font>Ping¶</font></font></a></h3>
<p><font><font>如果一切都失败，则始终会有UDP Ping，这将产生来自实时主机的ICMP端口不可达错误。</font><font>在这里，您可以选择最有可能关闭的任何端口，例如端口0：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>sr </font></font></span><span class="p"><font><font>（</font></font></span> <span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168。*。1-10” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>UDP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dport </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>0 </font></font></span><span class="p"><font><font>）</font></font></span> <span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
<p><font><font>再次，可以使用以下命令收集结果：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>概要</font></font></span><span class="p"><font><font>（</font></font></span> <span class="k"><font><font>拉姆达</font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R ）</font></font></span><font><span class="p"><font>：</font></span></font><span class="p"><font><font> </font></font></span> <font><span class="n"><font>- [R </font></span><span class="o"><font>。</font></span><span class="n"><font>的sprintf </font></span><span class="p"><font>（</font></span><span class="s"><font>“％IP.src </font></span><span class="si"><font>％I </font></span><span class="s"><font>还活着” </font></span><span class="p"><font>）</font></span><span class="p"><font>）</font></span></font><span class="p"><font></font></span> <span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span><span class="s"><font></font></span><span class="si"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span> <span class="p"><font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="classical-attacks">
<h3><font><font>古典攻击</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#classical-attacks" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p><font><font>格式错误的数据包：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>send </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“10.1.1.5” </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>ihl </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>2 </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>version </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>3 </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>ICMP </font></font></span><span class="p"><font><font>（））</font></font></span>
</pre></div>
</div>
<p><font><font>平安（Muuahahah）：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>send </font></font></span><span class="p"><font><font>（</font></font></span> <span class="n"><font><font>fragment </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“10.0.0.5” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>ICMP </font></font></span><span class="p"><font><font>（）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“X” </font></font></span><span class="o"><font><font>* </font></font></span><span class="mi"><font><font>60000 </font></font></span><span class="p"><font><font>））</font></font></span> <span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
<p><font><font>雀巢攻击：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>发送</font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>目标</font></font></span><span class="p"><font><font>，</font></font></span> <span class="nb"><font><font>ID </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>42 </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>标志</font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“MF” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>UDP </font></font></span><span class="p"><font><font>（）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“X” </font></font></span><span class="o"><font><font>* </font></font></span><span class="mi"><font><font>10 </font></font></span><span class="p"><font><font>））</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>发送</font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>目标</font></font></span><span class="p"><font><font>，</font></font></span> <span class="nb"><font><font>ID </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>42 </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>FRAG </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>48 </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“X” </font></font></span><span class="o"><font><font>* </font></font></span><span class="mi"><font><font>116 </font></font></span><span class="p"><font><font>））</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt;</font></font></span><span class="n"><font><font>发送</font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>target </font></font></span><span class="p"><font><font>，</font></font></span> <span class="nb"><font><font>id </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>42 </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>flags </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“MF” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>UDP </font></font></span><span class="p"><font><font>（）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“X” </font></font></span><span class="o"><font><font>* </font></font></span><span class="mi"><font><font>224 </font></font></span><span class="p"><font><font>））</font></font></span>
</pre></div>
</div>
<p><font><font>土地攻击（专为Microsoft Windows而设计）：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>send </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>src </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>target </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>target </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>sport </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>135 </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>dport </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>135 </font></font></span><span class="p"><font><font>））</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="arp-cache-poisoning">
<h3><font><font>ARP缓存中毒</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#arp-cache-poisoning" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p><font><font>此攻击可防止客户端通过VLAN跳跃攻击中毒其ARP缓存来加入网关。</font></font></p>
<p><font><font>经典ARP缓存中毒：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>send </font></font></span><span class="p"><font><font>（</font></font></span> <span class="n"><font><font>Ether </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>clientMAC </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>ARP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>op </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“who- </font></font></span><font><span class="n"><font>have </font></span><span class="s"><font>” </font></span></font><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>psrc </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>gateway </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>pdst </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>client </font></font></span><span class="p"><font><font>），</font></font></span>
<span class="go"><font><font>      inter = RandNum（10,40），loop = 1）</font></font></span>
</pre></div>
</div>
<p><font><font>具有双重802.1q封装的ARP缓存中毒：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>send </font></font></span><span class="p"><font><font>（</font></font></span> <span class="n"><font><font>Ether </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>clientMAC </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>Dot1Q </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>vlan </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>Dot1Q </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>vlan </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>2 </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>      / ARP（op =“who-have”，psrc = gateway，pdst = client），</font></font></span>
<span class="go"><font><font>      inter = RandNum ，40），loop = 1）</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="tcp-port-scanning">
<h3><font><font>TCP端口扫描</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#tcp-port-scanning" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p><font><font>在每个端口上发送TCP SYN。</font><font>等待SYN-ACK或RST或ICMP错误：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>res </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>sr </font></font></span><span class="p"><font><font>（</font></font></span> <span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“target” </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>                / TCP（flags =“S”，dport =（1,1024）））</font></font></span>
</pre></div>
</div>
<p><font><font>可能的结果可视化：打开端口</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>水库</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>nsummary </font></font></span><span class="p"><font><font>（</font></font></span> <span class="n"><font><font>lfilter </font></font></span><span class="o"><font><font>= </font></font></span><span class="k"><font><font>拉姆达</font></font></span> <span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R </font></font></span><span class="p"><font><font>）：</font></font></span> <span class="p"><font><font>（</font></font></span><font><span class="p"><font> </font></span></font><span class="n"><font><font>- [R </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>haslayer </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>）</font></font></span> <span class="ow"><font><font>和</font></font></span> <span class="p"><font><font>（</font></font></span><span class="n"><font><font>- [R </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>getlayer </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>标志</font></font></span> <span class="o"><font><font>＆</font></font></span> <span class="mi"><font><font>2 </font></font></span><span class="p"><font><font>）） </font></font></span> <span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="ike-scanning">
<h3><font><font>IKE扫描</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#ike-scanning" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p><font><font>我们尝试通过发送ISAKMP安全协议提案并收到答案来识别VPN集中器：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>res </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>sr </font></font></span><span class="p"><font><font>（</font></font></span> <span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168.1。*” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>UDP </font></font></span><span class="p"><font><font>（）</font></font></span>
<span class="go"><font><font>                / ISAKMP（init_cookie = RandString（8），exch_type =“identity prot。”）</font></font></span>
<span class="go"><font><font>                / ISAKMP_payload_SA（prop = ISAKMP_payload_Proposal ））</font></font></span>
<span class="go"><font><font>              ）</font></font></span>
</pre></div>
</div>
<p><font><font>在列表中显示结果：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>水库</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>nsummary </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>PRN </font></font></span><span class="o"><font><font>= </font></font></span><span class="k"><font><font>拉姆达</font></font></span> <span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R </font></font></span><span class="p"><font><font>）：</font></font></span> <span class="n"><font><font>- [R </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>SRC </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>lfilter </font></font></span><span class="o"><font><font>= </font></font></span><span class="k"><font><font>拉姆达</font></font></span> <span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R </font></font></span><span class="p"><font><font>）：</font></font></span> <span class="n"><font><font>- [R </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>haslayer </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>ISAKMP </font></font></span><span class="p"><font><font>）</font></font></span> <span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="advanced-traceroute">
<h3><font><font>高级跟踪路由</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#advanced-traceroute" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<div class="section" id="tcp-syn-traceroute">
<h4><font><font>TCP SYN跟踪路由</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#tcp-syn-traceroute" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ANS </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>SR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“4.2.2.1” </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>TTL </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>（</font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>10 </font></font></span><span class="p"><font><font>））</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DPORT </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>53 </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>标志</font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“S” </font></font></span><span class="p"><font><font>））</font></font></span>
</pre></div>
</div>
<p><font><font>结果将是：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>概要</font></font></span><span class="p"><font><font>（</font></font></span> <span class="k"><font><font>拉姆达</font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R ）</font></font></span><font><span class="p"><font>：</font></span></font><span class="p"><font><font> </font></font></span> <font><span class="n"><font>- [R </font></span><span class="o"><font>。</font></span><span class="n"><font>的sprintf </font></span><span class="p"><font>（</font></span><span class="s"><font>“％IP.src％</font></span><span class="se"><font>\吨</font></span><span class="s"><font>{ICMP：％ICMP.type％} </font></span><span class="se"><font>\吨</font></span><span class="s"><font>{TCP：％TCP.flags％}” </font></span><span class="p"><font>））</font></span><span class="go"><font>192.168.1.1时间超过</font></span><span class="go"><font>68.86.90.162超时</font></span><span class="go"><font>4.79.43.134超时</font></span><span class="go"><font>4.79.43.133超时</font></span><span class="go"><font>4.68.18.126超时</font></span><span class="go"><font>4.68.123.38超时</font></span><span class="go"><font>4.2.2.1 SA</font></span></font><span class="p"><font></font></span> <span class="n"><font></font></span><span class="o"><font></font></span><span class="n"><font></font></span><span class="p"><font></font></span><span class="s"><font></font></span><span class="se"><font></font></span><span class="s"><font></font></span><span class="se"><font></font></span><span class="s"><font></font></span><span class="p"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="udp-traceroute">
<h4><font><font>UDP路由跟踪</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#udp-traceroute" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>像TCP我们这样做的UDP应用程序是不可靠的，因为没有握手。</font><font>我们需要给出适用的有效载荷（DNS，ISAKMP，NTP等），以获得答案：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>RES </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>SR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“目标” </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>TTL </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>（</font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>20 </font></font></span><span class="p"><font><font>））</font></font></span>
<span class="go"><font><font>              /UDP()/DNS(qd=DNSQR(qname="test.com“））</font></font></span>
</pre></div>
</div>
<p><font><font>我们可以将结果可视化为路由器列表：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>水库</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>make_table </font></font></span><span class="p"><font><font>（</font></font></span><span class="k"><font><font>拉姆达</font></font></span> <span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R </font><font>）：</font></font></span><span class="p"><font><font> </font></font></span> <span class="p"><font><font>（</font></font></span><span class="n"><font><font>小号</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>DST </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>小号</font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>TTL </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>- [R </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>SRC </font></font></span><span class="p"><font><font>））</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="dns-traceroute">
<h4><font><font>DNS跟踪路由</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#dns-traceroute" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>我们可以通过在</font><tt class="docutils literal"><span class="pre"><font>traceroute（）</font></span></tt><font>函数的</font></font><tt class="docutils literal"><span class="pre"><font><font>l4</font></font></span></tt><font><font>参数中</font><font>指定完整的数据包来执行DNS跟踪</font></font><tt class="docutils literal"><span class="pre"><font><font>路由</font></font></span></tt><font><font>：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>traceroute </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“4.2.2.1” </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>l4 </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>UDP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>sport </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>RandShort </font></font></span><span class="p"><font><font>（））</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>DNS </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>qd </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>DNSQR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>qname </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“thesprawl.org” </font></font></span><span class="p"><font><font>）））</font></font></span>
<span class="go"><font><font>开始发射：</font></font></span>
<span class="go"><font><font>.. * .. ****** ****** *** *** ***完成发送30包。</font></font></span>
<span class="go"><font><font>***** ... *** ............................... </font></font></span>
<span class="go"><font><font>收到75包，得到28个答案，剩余2包</font></font></span>
<span class="go"><font><font>   4.2.2.1:udp53 </font></font></span>
<span class="go"><font><font>1 192.168.1.1 11 </font></font></span>
<span class="go"><font><font>4 68.86.90.162 11 </font></font></span>
<span class="go"><font><font>5 4.79.43.134 11 </font></font></span>
<span class="go"><font><font>6 4.79.43.133 11 </font></font></span>
<span class="go"><font><font>7 4.68.18。</font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="gp"><font></font></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="etherleaking">
<h3><font><font>过滤</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#etherleaking" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>sr1 </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“172.16.1.232” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>ICMP </font></font></span><span class="p"><font><font>（））</font></font></span>
<span class="go"><font><font>&lt;IP src = 172.16.1.232 proto = 1 [...] | &lt;ICMP code = 0 type = 0 [...] </font></font></span>
<span class="go"><font><font>&lt;Padding load ='0O \ x02 \ x01 \ x00 \ x04 \ x06public \ xa2B \ x02 \ x02 \ x1e'| &gt;&gt;&gt;</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="icmp-leaking">
<h3><font><font>ICMP泄漏</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#icmp-leaking" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p><font><font>这是一个Linux 2.0的bug：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>sr1 </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“172.16.1.1” </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>options </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“ </font></font></span><span class="se"><font><font>\ x02 </font></font></span><span class="s"><font><font>” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>ICMP </font></font></span><span class="p"><font><font>（））</font></font></span>
<span class="go"><font><font>&lt;IP src = 172.16.1.1 [...] | &lt;ICMP code = 0 type = 12 [。 ..] </font></font></span>
<span class="go"><font><font>&lt;IPerror src = 172.16.1.24 options ='\ x02 \ x00 \ x00 \ x00'[...] </font></font></span>
<span class="go"><font><font>&lt;ICMPerror code = 0 type = 8 id = 0x0 seq = 0x0 chksum = 0xf7ff | </font></font></span>
<span class="go"><font><font>&lt;padding load ='\ x00 [...] \ x00 \ x1d。\ x00V \ x1f \ xaf \ xd9 \ xd4; \ xca'| &gt;&gt;&gt;&gt;&gt;</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="vlan-hopping">
<h3><font><font>VLAN跳跃</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#vlan-hopping" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p><font><font>在非常具体的条件下，双重802.1q封装将使数据包跳转到另一个VLAN：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>sendp </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>Ether </font></font></span><span class="p"><font><font>（）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>Dot1Q </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>vlan </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>2 </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>Dot1Q </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>vlan </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>7 </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>target </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>ICMP </font></font></span><span class="p"><font><font>（））</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="wireless-sniffing">
<h3><font><font>无线嗅觉</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#wireless-sniffing" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p><font><font>以下命令将显示与大多数无线嗅探器类似的信息：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>嗅探</font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IFACE </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“ATH0” </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>PRN </font></font></span><span class="o"><font><font>= </font></font></span><span class="k"><font><font>拉姆达</font></font></span> <span class="n"><font><font>X </font></font></span><span class="p"><font><font>：</font></font></span><span class="n"><font><font>X </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>的sprintf </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“{Dot11Beacon：％Dot11.addr3％</font></font></span><span class="se"><font><font>\吨</font></font></span><span class="s"><font><font>％Dot11Beacon.info％</font></font></span><span class="se"><font><font>\吨</font></font></span><span class="s"><font><font>％PrismHeader.channel％</font></font></span><span class="se"><font><font>\吨</font></font></span><span class="s"><font><font>Dot11Beacon.cap％} “ </font></font></span><span class="p"><font><font>））</font></font></span>
</pre></div>
</div>
<p><font><font>上述命令将产生类似于下面的输出：</font></font></p>
<div class="highlight-python"><pre><font><font>00：00：00：01：02：03 netgear 6L ESS +隐私+ PBCC </font></font><font><font>
11：22：33：44：55：66 wireless_100 6L短插槽+ ESS +隐私</font></font><font><font>
44：55：66：00：11：22 6L短插槽+ ESS +隐私</font></font><font><font>
12：34：56：78：90：12 NETGEAR 6L短插槽+ ESS +隐私+短前置码</font></font></pre>
</div>
</div>
</div>
<div class="section" id="recipes">
<h2><font><font>食谱</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#recipes" title="固定到这个标题"><font><font>¶</font></font></a></h2>
<div class="section" id="simplistic-arp-monitor">
<h3><font><font>简单的ARP监控</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#simplistic-arp-monitor" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p><font><font>该程序使用</font></font><tt class="docutils literal"><span class="pre"><font><font>sniff（）</font></font></span></tt><font><font>回调（参数prn）。</font><font>存储参数设置为0，以使</font></font><tt class="docutils literal"><span class="pre"><font><font>sniff（）</font></font></span></tt><font><font>函数不会存储任何东西（否则将会存储），因此可以永久运行。</font><font>过滤器参数用于在高负载下获得更好的性能：过滤器应用在内核中，Scapy只会看到ARP流量。</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"><font><font>＃！</font><font>/ usr / bin / env python </font></font></span>
<span class="kn"><font><font>从</font></font></span> <span class="nn"><font><font>scapy.all </font></font></span> <span class="kn"><font><font>import </font></font></span> <span class="o"><font><font>* </font></font></span>

<span class="k"><font><font>def </font></font></span> <span class="nf"><font><font>arp_monitor_callback </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>pkt </font></font></span><span class="p"><font><font>）：</font></font></span>
    <span class="k"><font><font>如果</font></font></span> <span class="n"><font><font>ARP </font></font></span> <span class="ow"><font><font>在</font></font></span> <span class="n"><font><font>pkt </font></font></span> <span class="ow"><font><font>和</font></font></span> <span class="n"><font><font>pkt </font></font></span><span class="p"><font><font>[ </font></font></span><span class="n"><font><font>ARP </font></font></span><span class="p"><font><font>] </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>运算</font></font></span> <span class="ow"><font><font>在</font></font></span> <span class="p"><font><font>（</font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>2 </font></font></span><span class="p"><font><font>）： </font></font></span> <span class="c"><font><font>＃</font><font>谁-具有或-在</font></font></span>
        <span class="k"><font><font>返回</font></font></span> <span class="n"><font><font>PKT </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>sprintf </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“％ARP.hwsrc </font></font></span><span class="si"><font><font>％％</font></font></span><span class="s"><font><font>ARP.psrc％” </font></font></span><span class="p"><font><font>）</font></font></span>

<span class="n"><font><font>sniff </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>prn </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>arp_monitor_callback </font></font></span><span class="p"><font><font>，</font></font></span> <span class="nb"><font><font>filter </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“arp” </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>store </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>0 </font></font></span><span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="identifying-rogue-dhcp-servers-on-your-lan">
<h3><font><font>在你的局域网识别恶意DHCP服务器</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#identifying-rogue-dhcp-servers-on-your-lan" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<div class="section" id="problem">
<span id="index-26"></span><h4><font><font>问题</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#problem" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>您怀疑有人在您的局域网上安装了一个额外的未经授权的DHCP服务器 - 无意中或恶意地。</font><font>因此，您要检查任何活动的DHCP服务器，并标识其IP和MAC地址。</font></font></p>
</div>
<div class="section" id="solution">
<h4><font><font>解决方案</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#solution" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>使用Scapy发送DHCP发现请求并分析回复：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>CONF </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>checkIPaddr </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="bp"><font><font>假</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>FAM </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>HW </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>get_if_raw_hwaddr </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>CONF </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>IFACE </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>DHCP_DISCOVER </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>以太</font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“FF：FF：FF：FF：FF：FF” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>SRC </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“0.0.0.0” </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“255.255.255.255” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>UDP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>运动</font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>68 </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>DPORT </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>67 </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>BOOTP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>CHADDR </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>HW </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>DHCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>选项</font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>[（ </font></font></span><span class="s"><font><font>“ </font><font>消息类型” </font></font></span><span class="p"><font><font>，</font></font></span><span class="s"><font><font>“发现” </font></font></span><span class="p"><font><font>）， </font></font></span><span class="s"><font><font>“ </font><font>结束” </font></font></span><span class="p"><font><font>]）</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ANS </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>unans </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>SRP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DHCP_DISCOVER </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>多</font></font></span><span class="o"><font><font>= </font></font></span><span class="bp"><font><font>真</font></font></span><span class="p"><font><font>）</font></font></span>      <span class="c"><font><font>＃几秒钟后按CTRL-C </font></font></span>
<span class="go"><font><font>开始发射：</font></font></span>
<span class="go"><font><font>完成发送1个数据包。</font></font></span>
<span class="go"><font><font>。* ... * .. </font></font></span>
<font><span class="go"><font>收到8个数据包，得到2个答案，剩下0个数据包 </font></span><span class="s"><font>“end” </font></span><span class="p"><font>]）</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>ans </font></span><span class="p"><font>，</font></span><span class="n"><font>unans </font></span><span class="o"><font>= </font></span><span class="n"><font>srp </font></span><span class="p"><font>（</font></span><span class="n"><font>dhcp_discover </font></span><span class="p"><font>，</font></span><span class="n"><font>multi </font></span><span class="o"><font>= </font></span><span class="bp"><font>True </font></span><span class="p"><font>）</font></span><span class="c"><font>＃几秒钟后按CTRL-C </font></span><span class="go"><font>开始发射：</font></span><span class="go"><font>完成发送1个数据包。</font></span><span class="go"><font>。* ... * .. </font></span><span class="go"><font>收到8个数据包，得到2个答案，剩下0个数据包 </font></span><span class="s"><font>“end” </font></span><span class="p"><font>]）</font></span><span class="gp"><font>&gt;&gt;&gt; </font></span><span class="n"><font>ans </font></span><span class="p"><font>，</font></span><span class="n"><font>unans </font></span><span class="o"><font>= </font></span><span class="n"><font>srp </font></span><span class="p"><font>（</font></span><span class="n"><font>dhcp_discover </font></span><span class="p"><font>，</font></span><span class="n"><font>multi </font></span><span class="o"><font>= </font></span><span class="bp"><font>True </font></span><span class="p"><font>）</font></span><span class="c"><font>＃几秒钟后按CTRL-C </font></span><span class="go"><font>开始发射：</font></span><span class="go"><font>完成发送1个数据包。</font></span><span class="go"><font>。* ... * .. </font></span></font><span class="go"><font><font>收到8个数据包，得到2个答案，剩下0个数据包</font></font></span>
</pre></div>
</div>
<p><font><font>在这种情况下，我们有2个回复，所以在测试网络上有两个活动的DHCP服务器：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>summary </font></font></span><span class="p"><font><font>（）</font></font></span>
<span class="go"><font><font>Ether / IP / UDP 0.0.0.0:bootpc&gt; 255.255.255.255:bootps / BOOTP / DHCP ==&gt;以太/ IP / UDP 192.168.1.1:bootps&gt; 255.255.255.255:bootpc / BOOTP / DHCP </font></font></span>
<span class="go"><font><font>以太/ IP / UDP 0.0.0.0:bootpc&gt; 255.255.255.255:bootps / BOOTP / DHCP ==&gt;以太/ IP / UDP 192.168.1.11:bootps&gt; 255.255.255.255:bootpc / BOOTP / DHCP </font></font></span>
<span class="go"><font><font>}}} </font></font></span>
<span class="go"><font><font>我们只对MAC和答复的IP地址：</font></font></span>
<span class="go"><font><font>{{{ </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="k"><font><font>for </font></font></span> <span class="n"><font><font>p </font></font></span> <span class="ow"><font><font>in </font></font></span> <span class="n"><font><font>ans </font></font></span><span class="p"><font><font>：</font></font></span> <span class="k"><font><font>print </font></font></span> <span class="n"><font><font>p </font></font></span><span class="p"><font><font>[ </font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>] [ </font></font></span><span class="n"><font><font>Ether </font></font></span><span class="p"><font><font>] </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>src </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>p </font></font></span><span class="p"><font><font>[ </font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>] [ </font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>] </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font></font></span>
<span class="gp"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="discussion">
<h4><font><font>讨论</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#discussion" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>我们指定</font></font><tt class="docutils literal"><span class="pre"><font><font>multi = True</font></font></span></tt><font><font>，使得Scapy在收到第一个响应后等待更多的应答数据包。</font><font>这也是为什么我们不能使用更方便的</font></font><tt class="docutils literal"><span class="pre"><font><font>dhcp_request（）</font></font></span></tt><font><font>函数并且必须手动构造DCHP数据包的原因：</font></font><tt class="docutils literal"><span class="pre"><font><font>dhcp_request（）</font></font></span></tt><font><font>使用</font></font><tt class="docutils literal"><span class="pre"><font><font>srp1（）</font></font></span></tt><font><font>进行发送和接收，因此将在第一个应答数据包之后立即返回。</font></font></p>
<p><font><font>此外，Scapy通常会确保答复来自同一IP地址的刺激被发送到。</font><font>但是我们的DHCP报文被发送到IP广播地址（255.255.255.255），任何应答报文将具有DHCP服务器的IP地址作为其源IP地址（例如192.168.1.1）。</font><font>因为这些IP地址不匹配，我们必须</font><font>在发送刺激之前</font><font>使用</font></font><tt class="docutils literal"><span class="pre"><font><font>conf.checkIPaddr </font></font></span> <span class="pre"><font><font>= </font></font></span> <span class="pre"><font><font>False</font></font></span></tt><font><font>禁用Scapy的检查</font><font>。</font></font></p>
</div>
<div class="section" id="see-also">
<h4><font><font>另见</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#see-also" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Rogue_DHCP"><font><font>http://en.wikipedia.org/wiki/Rogue_DHCP</font></font></a></p>
</div>
</div>
<div class="section" id="firewalking">
<h3><font><font>火行</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#firewalking" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<p><font><font>过滤操作后TTL递减，只有没有过滤的数据包才产生超过ICMP的TTL</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ANS </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>unans </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>SR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“172.16.4.27” </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>TTL </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>16 </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DPORT </font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>（</font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>1024 </font></font></span><span class="p"><font><font>）））</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="k"><font><font>用于</font></font></span> <span class="n"><font><font>小号</font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>- [R </font></font></span> <span class="ow"><font><font>在</font></font></span> <span class="n"><font><font>ANS </font></font></span><span class="p"><font><font>：</font></font></span>
<span class="go"><font><font>        如果r.haslayer（ ICMP）和r.payload.type == 11：</font></font></span>
<span class="go"><font><font>            print s.dport</font></font></span>
</pre></div>
</div>
<p><font><font>在多NIC防火墙上查找子网，只有自己的网卡的IP可以通过这个TTL可达：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>unans </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>sr </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“172.16.5 / 24” </font></font></span><span class="p"><font><font>，</font></font></span> <span class="n"><font><font>ttl </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>15 </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（））</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="k"><font><font>对于</font></font></span> <span class="n"><font><font>我</font></font></span> <span class="ow"><font><font>在</font></font></span> <span class="n"><font><font>unans </font></font></span><span class="p"><font><font>：</font></font></span> <span class="k"><font><font>print </font></font></span> <span class="n"><font><font>i </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>DST</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="tcp-timestamp-filtering">
<h3><font><font>TCP时间戳过滤</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#tcp-timestamp-filtering" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<div class="section" id="id1">
<h4><font><font>问题</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#id1" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>许多防火墙包括一个规则来删除没有TCP时间戳选项集的TCP数据包，这在通用端口扫描器中是常见的。</font></font></p>
</div>
<div class="section" id="id2">
<h4><font><font>解决方案</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#id2" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>要使Scapy达到目标目的地，必须使用其他选项：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>SR1 </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DST </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“72.14.207.99” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>DPORT </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>80 </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>标志</font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“S” </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>选项</font></font></span><span class="o"><font><font>= </font></font></span><span class="p"><font><font>[（</font></font></span><span class="s"><font><font>'时间戳' </font></font></span><span class="p"><font><font>，（</font></font></span><span class="mi"><font><font>0 </font></font></span><span class="p"><font><font>，</font></font></span><span class="mi"><font><font>0 </font></font></span><span class="p"><font><font>））]））</font></font></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="viewing-packets-with-wireshark">
<h3><font><font>用Wireshark查看数据包</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#viewing-packets-with-wireshark" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<div class="section" id="index-27">
<span id="id3"></span><h4><font><font>问题</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#index-27" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>您已经使用Scapy生成或嗅探了一些数据包，并希望使用</font></font><a class="reference external" href="http://www.wireshark.org/"><font><font>Wireshark</font></font></a><font><font>查看它们</font><font>，因为它具有先进的数据包解析能力。</font></font></p>
</div>
<div class="section" id="id4">
<h4><font><font>解决方案</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#id4" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>这就是</font></font><tt class="docutils literal"><span class="pre"><font><font>wireshark（）</font></font></span></tt><font><font>函数的用途：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>packets </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>Ether </font></font></span><span class="p"><font><font>（）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>Net </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“google.com/30” </font></font></span><span class="p"><font><font>））</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>ICMP </font></font></span><span class="p"><font><font>（）</font></font></span>     <span class="c"><font><font>＃首先生成一些数据包</font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>wireshark </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>packets </font></font></span><span class="p"><font><font>）</font></font></span>                                        <span class="c"><font><font>＃显示与Wireshark</font></font></span>
</pre></div>
</div>
<p><font><font>Wireshark将在后台启动并显示您的数据包。</font></font></p>
</div>
<div class="section" id="id5">
<h4><font><font>讨论</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#id5" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>该</font></font><tt class="docutils literal"><span class="pre"><font><font>Wireshark的（）</font></font></span></tt><font><font>函数生成包含你的数据包的临时PCAP文件，在后台启动Wireshark的，并使其在启动时读取该文件。</font></font></p>
<p><font><font>请记住，Wireshark使用第2层数据包（通常称为“帧”）。</font><font>所以我们不得不在</font><font>我们的ICMP数据包中</font><font>添加一个</font></font><tt class="docutils literal"><span class="pre"><font><font>Ether（）</font></font></span></tt><font><font>头。</font><font>将IP包（第3层）传递给Wireshark将会产生奇怪的结果。</font></font></p>
<p><font><font>您可以通过更改</font></font><tt class="docutils literal"><span class="pre"><font><font>conf.prog.wireshark</font></font></span></tt><font><font>配置设置</font><font>来告诉Scapy在哪里可以找到Wireshark可执行文件</font><font>。</font></font></p>
</div>
</div>
<div class="section" id="os-fingerprinting">
<h3><font><font>操作系统指纹</font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#os-fingerprinting" title="固定到这个标题"><font><font>¶</font></font></a></h3>
<div class="section" id="isn">
<h4><font><font>ISN </font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#isn" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>Scapy可用于分析ISN（初始序列号）增量，以发现易受攻击的系统。</font><font>首先，我们将通过在循环中发送一些SYN探针来收集目标响应：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>ans </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>unans </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>srloop </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>IP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dst </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“192.168.1.1” </font></font></span><span class="p"><font><font>）</font></font></span><span class="o"><font><font>/ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>dport </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>80 </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>flags </font></font></span><span class="o"><font><font>= </font></font></span><span class="s"><font><font>“S” </font></font></span><span class="p"><font><font>））</font></font></span>
</pre></div>
</div>
<p><font><font>一旦我们获得合理数量的回复，我们就可以开始分析收集的数据，如下所示：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>temp </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="mi"><font><font>0 </font></font></span>
<span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="k"><font><font>for </font></font></span> <span class="n"><font><font>s </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>r </font></font></span> <span class="ow"><font><font>in </font></font></span> <span class="n"><font><font>ans </font></font></span><span class="p"><font><font>：</font></font></span>
<span class="gp"><font><font>... </font></font></span>   <span class="n"><font><font>temp </font></font></span> <span class="o"><font><font>= </font></font></span> <span class="n"><font><font>r </font></font></span><span class="p"><font><font>[ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>] </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>SEQ </font></font></span> <span class="o"><font><font>- </font></font></span> <span class="n"><font><font>温度</font></font></span>
<span class="gp"><font><font>... </font></font></span>   <span class="k"><font><font>打印</font></font></span> <span class="nb"><font><font>STR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>[R </font></font></span><span class="p"><font><font>[ </font></font></span><span class="n"><font><font>TCP </font></font></span><span class="p"><font><font>] </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>SEQ </font></font></span><span class="p"><font><font>）</font></font></span> <span class="o"><font><font>+ </font></font></span> <span class="s"><font><font>“ </font></font></span><span class="se"><font><font>\吨</font></font></span><span class="s"><font><font>+” </font></font></span> <span class="o"><font><font>+ </font></font></span> <span class="nb"><font><font>STR </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>临时</font></font></span><span class="p"><font><font>）</font></font></span>
<span class="gp"><font><font>...</font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
<span class="go"><font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="nmap-fp">
<h4><font><font>nmap_fp </font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#nmap-fp" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>在Scapy中支持Nmap指纹（旧的“第一代”，由Nmap完成v4.20）。</font><font>在Scapy v2中，您必须首先加载扩展模块：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>load_module </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“nmap” </font></font></span><span class="p"><font><font>）</font></font></span>
</pre></div>
</div>
<p><font><font>如果你安装了Nmap，你可以使用它的主动os指纹数据库与Scapy。</font><font>确保签名数据库的版本1位于以下指定的路径中：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>CONF </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>nmap_base</font></font></span>
</pre></div>
</div>
<p><font><font>然后，您可以使用</font></font><tt class="docutils literal"><span class="pre"><font><font>nmap_fp（）</font></font></span></tt><font><font>函数实现与Nmap的OS Detection引擎相同的探测：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>nmap_fp </font></font></span><span class="p"><font><font>（</font></font></span><span class="s"><font><font>“192.168.1.1” </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>oport </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>443 </font></font></span><span class="p"><font><font>，</font></font></span><span class="n"><font><font>cport </font></font></span><span class="o"><font><font>= </font></font></span><span class="mi"><font><font>1 </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>开始发射：</font></font></span>
<span class="go"><font><font>。**** .. **完成发送8个数据包。</font></font></span>
<span class="go"><font><font>* ................................................ </font></font></span>
<span class="go"><font><font>收到58个数据包，得到7个答案，剩下1个数据包</font></font></span>
<span class="go"><font><font>（1.0，['Linux 2.4.0  -  2.5.20'，'Linux 2.4.19 w / grsecurity patch'，</font></font></span>
<span class="go"><font><font>'Linux 2.4.20  -  2.4.22 w / grsecurity.org补丁“，”Linux 2.4.22-ck2（x86）</font></font></span>
<span class="go"><font><font>w / grsecurity.org和HZ = 1000个补丁“，”Linux 2.4.7  -  2.6.11“））</font></font></span>
</pre></div>
</div>
</div>
<div class="section" id="p0f">
<h4><font><font>p0f </font></font><a class="headerlink" href="http://www.secdev.org/projects/scapy/doc/usage.html#p0f" title="固定到这个标题"><font><font>¶</font></font></a></h4>
<p><font><font>如果您的系统上安装了p0f，您可以使用它从Scapy中猜出操作系统名称和版本（仅使用SYN数据库）。</font><font>首先确保p0f数据库存在于以下指定的路径中：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>CONF </font></font></span><span class="o"><font><font>。</font></font></span><span class="n"><font><font>p0f_base</font></font></span>
</pre></div>
</div>
<p><font><font>例如，从单个捕获的数据包猜测操作系统：</font></font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp"><font><font>&gt;&gt;&gt; </font></font></span><span class="n"><font><font>sniff </font></font></span><span class="p"><font><font>（</font></font></span><span class="n"><font><font>prn </font></font></span><span class="o"><font><font>= </font></font></span><span class="n"><font><font>prnp0f </font></font></span><span class="p"><font><font>）</font></font></span>
<span class="go"><font><font>192.168.1.100:54716  -  Linux 2.6（更新，1）（up：24 hrs）</font></font></span>
<span class="go"><font><font>  - &gt; 74.125.19.104:www（distance 0）</font></font></span>
<span class="go"><font><font>&lt;Sniffed：TCP：339 UDP：2 ICMP： 0其他：156&gt;</font></font></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="http://www.secdev.org/projects/scapy/doc/index.html"><font><font>目录</font></font></a></h3>
            <ul>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#"><font><font>用法</font></font></a><ul>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#starting-scapy"><font><font>开始Scapy</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#interactive-tutorial"><font><font>互动教程</font></font></a><ul>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#first-steps"><font><font>第一步</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#stacking-layers"><font><font>堆叠层</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#reading-pcap-files"><font><font>阅读PCAP文件</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#graphical-dumps-pdf-ps"><font><font>图形转储（PDF，PS）</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#generating-sets-of-packets"><font><font>生成数据包集</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#sending-packets"><font><font>发送数据包</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#fuzzing"><font><font>起毛</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#send-and-receive-packets-sr"><font><font>发送和接收数据包（sr）</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#syn-scans"><font><font>SYN扫描</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#tcp-traceroute"><font><font>TCP跟踪路由</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#configuring-super-sockets"><font><font>配置超级套接字</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#sniffing"><font><font>嗅探</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#filters"><font><font>过滤器</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#send-and-receive-in-a-loop"><font><font>发送和接收循环</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#importing-and-exporting-data"><font><font>导入和导出数据</font></font></a><ul>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#pcap"><font><font>PCAP</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#hexdump"><font><font>进制打印</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#hex-string"><font><font>十六进制字符串</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#base64"><font><font>Base64编码</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#sessions"><font><font>会议</font></font></a></li>
</ul>
</li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#making-tables"><font><font>制作桌子</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#routing"><font><font>路由</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#gnuplot"><font><font>gnuplot的</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#tcp-traceroute-2"><font><font>TCP跟踪路由（2）</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#wireless-frame-injection"><font><font>无线帧注入</font></font></a></li>
</ul>
</li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#simple-one-liners"><font><font>简单的单排</font></font></a><ul>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#ack-scan"><font><font>ACK扫描</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#xmas-scan"><font><font>圣诞扫描</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#ip-scan"><font><font>IP扫描</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#arp-ping"><font><font>ARP Ping</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#icmp-ping"><font><font>ICMP Ping</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#tcp-ping"><font><font>TCP Ping</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#udp-ping"><font><font>UDP Ping</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#classical-attacks"><font><font>古典攻击</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#arp-cache-poisoning"><font><font>ARP缓存中毒</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#tcp-port-scanning"><font><font>TCP端口扫描</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#ike-scanning"><font><font>IKE扫描</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#advanced-traceroute"><font><font>高级跟踪路由</font></font></a><ul>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#tcp-syn-traceroute"><font><font>TCP SYN跟踪路由</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#udp-traceroute"><font><font>UDP traceroute</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#dns-traceroute"><font><font>DNS traceroute</font></font></a></li>
</ul>
</li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#etherleaking"><font><font>Etherleaking</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#icmp-leaking"><font><font>ICMP泄漏</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#vlan-hopping"><font><font>VLAN跳频</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#wireless-sniffing"><font><font>无线嗅探</font></font></a></li>
</ul>
</li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#recipes"><font><font>食谱</font></font></a><ul>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#simplistic-arp-monitor"><font><font>简单ARP监控</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#identifying-rogue-dhcp-servers-on-your-lan"><font><font>识别LAN上的流氓DHCP服务器</font></font></a><ul>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#problem"><font><font>问题</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#solution"><font><font>解</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#discussion"><font><font>讨论</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#see-also"><font><font>也可以看看</font></font></a></li>
</ul>
</li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#firewalking"><font><font>Firewalking</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#tcp-timestamp-filtering"><font><font>TCP时间戳过滤</font></font></a><ul>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#id1"><font><font>问题</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#id2"><font><font>解</font></font></a></li>
</ul>
</li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#viewing-packets-with-wireshark"><font><font>用Wireshark查看数据包</font></font></a><ul>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#index-27"><font><font>问题</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#id4"><font><font>解</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#id5"><font><font>讨论</font></font></a></li>
</ul>
</li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#os-fingerprinting"><font><font>操作系统指纹</font></font></a><ul>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#isn"><font><font>ISN</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#nmap-fp"><font><font>nmap_fp</font></font></a></li>
<li><a class="reference external" href="http://www.secdev.org/projects/scapy/doc/usage.html#p0f"><font><font>p0f</font></font></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4><font><font>上一主题</font></font></h4>
            <p class="topless"><a href="http://www.secdev.org/projects/scapy/doc/installation.html" title="上一章"><font><font>下载并安装</font></font></a></p>
            <h4><font><font>下一个话题</font></font></h4>
            <p class="topless"><a href="http://www.secdev.org/projects/scapy/doc/advanced_usage.html" title="下一章"><font><font>高级用法</font></font></a></p>
            <h3><font><font>这一页</font></font></h3>
            <ul class="this-page-menu">
              <li><a href="http://www.secdev.org/projects/scapy/doc/_sources/usage.txt" rel="nofollow"><font><font>显示来源</font></font></a></li>
            </ul>
          <div id="searchbox" style="">
            <h3><font><font>快速搜索</font></font></h3>
              <form class="search" action="http://www.secdev.org/projects/scapy/doc/search.html" method="get">
                <input type="text" name="q" size="18">
                <font><font><input type="submit" value="走"></font></font>
                <input type="hidden" name="check_keywords" value="yes">
                <input type="hidden" name="area" value="default">
              </form>
              <p class="searchtip" style="font-size: 90%"><font><font>
              输入搜索字词或模块，类或函数名称。
              </font></font></p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3><font><font>导航</font></font></h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="http://www.secdev.org/projects/scapy/doc/genindex.html" title="一般指数"><font><font>指数</font></font></a></li>
        <li class="right">
          <a href="http://www.secdev.org/projects/scapy/doc/advanced_usage.html" title="高级用法"><font><font>下一个</font></font></a><font><font> |</font></font></li>
        <li class="right">
          <a href="http://www.secdev.org/projects/scapy/doc/installation.html" title="下载并安装"><font><font>上一页</font></font></a><font><font> |</font></font></li>
        <li><a href="http://www.secdev.org/projects/scapy/doc/index.html"><font><font>Scapy v2.1.1-dev文档</font></font></a><font><font> »</font></font></li> 
      </ul>
    </div>
    <div class="footer"><font><font>
      ©版权所有2008，2009 Philippe Biondi和Scapy社区。</font><font>最后更新于2010年4月19日。使用</font></font><a href="http://sphinx.pocoo.org/"><font><font>Sphinx</font></font></a><font><font> 0.6.4 </font><font>创建</font><font>。
    </font></font></div><div id="goog-gt-tt" class="goog-tooltip skiptranslate" dir="ltr" style="visibility: hidden; left: 664px; top: 1239px; display: none;"><div style="padding: 8px;"><div><div class="logo"><img src="https://www.gstatic.com/images/branding/product/1x/translate_24dp.png" width="20" height="20" alt="Google 翻译"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">原文</h1></div><div class="middle" style="padding: 8px;"><div class="original-text">&gt;&gt;&gt; IP()&lt;IP |&gt;&gt;&gt;&gt; IP()/TCP()&lt;IP frag=0 proto=TCP |&lt;TCP |&gt;&gt;&gt;&gt;&gt; Ether()/IP()/TCP()&lt;Ether type=0x800 |&lt;IP frag=0 proto=TCP |&lt;TCP |&gt;&gt;&gt;&gt;&gt;&gt; IP()/TCP()/"GET / HTTP/1.0\r\n\r\n"&lt;IP frag=0 proto=TCP |&lt;TCP |&lt;Raw load='GET / HTTP/1.0\r\n\r\n' |&gt;&gt;&gt;&gt;&gt;&gt; Ether()/IP()/IP()/UDP()&lt;Ether type=0x800 |&lt;IP frag=0 proto=IP |&lt;IP frag=0 proto=UDP |&lt;UDP |&gt;&gt;&gt;&gt;&gt;&gt;&gt; IP(proto=55)/TCP()&lt;IP frag=0 proto=55 |&lt;TCP |&gt;&gt;</div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">提供更好的翻译建议</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none; opacity: 0;"></div></div>
  
<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div></body></html>